[{"title":"\u521d\u8bc6creator","url":"https:\/\/naka1205.github.io\/cocos\/p\/60DA9CE88BF3343E.html","content":"\u521d\u8bc6creator\n\u6211\u4eec\u5728cocos creator\u65b0\u5efa\u4e00\u4e2aHello TypeScript\u9879\u76ee\uff0c\u90fd\u4f1a\u6709\u4e00\u4e2aassets\/Scene\/helloworld.fire\u6587\u4ef6\u3002\u4f7f\u7528cocos creator\u5f00\u53d1\u6e38\u620f\u65f6\uff0c\u9879\u76ee\u53ef\u4ee5\u53ea\u6709\u4e00\u4e2a.fire\u6587\u4ef6\u3002\u4e00\u822c\u5730\uff0c\u6211\u4f1a\u628a\u8fd9\u4e2a\u6587\u4ef6\u5939\u6539\u540d\u4e3aassets\/scene\uff0c\u4e0b\u9762\u53ea\u6709main.fire\u6587\u4ef6\uff1aassets\/scene\/main.fire\u3002\n\n\u53cc\u51fbmain.fire\u6587\u4ef6\uff0c\u5728\u5c42\u7ea7\u7ba1\u7406\u5668\u53ef\u4ee5\u770b\u5230\u5b83\u7684\u7ed3\u6784\n\n\u6839\u8282\u70b9\u662f\u4e00\u4e2aCanvas\uff0c\u70b9\u51fbCanvas\u8282\u70b9\uff0c\u5728\u53f3\u8fb9\u7684\u5c5e\u6027\u9762\u677f\u53ef\u4ee5\u770b\u5230Canvas\u7ec4\u4ef6\u6709Design Resolution\u5c5e\u6027\uff0c\u4f5c\u4e3a\u5c4f\u5e55\u9002\u914d\u7684\u5c3a\u5bf8\u3002\u4f8b\u5982\u8bbe\u7f6e\u4e3a1334x750\uff0c\u90a3\u4e48\u7f8e\u672f\u51fa\u8d44\u6e90\u65f6\u4e00\u5c4f\u754c\u9762\u7684\u5927\u5c0f\u5c31\u662f\u8fd9\u4e2a\u5c3a\u5bf8\u3002\u4e0d\u540c\u7684\u624b\u673a\u5c4f\u5e55\u5f15\u64ce\u81ea\u52a8\u505a\u7b49\u6bd4\u4f8b\u7f29\u653e\uff0c\u5177\u4f53\u7f29\u653e\u500d\u6570\uff0c\u5f53\u52fe\u9009Fix Width\u8868\u793a\u754c\u9762\u7684\u5bbd\u7f29\u653e\u5230\u8ddf\u5b9e\u9645\u5c4f\u5e55\u4e00\u6837\uff0c\u5f53\u52fe\u9009Fix Height\u8868\u793a\u754c\u9762\u7684\u9ad8\u7f29\u653e\u5230\u8ddf\u5b9e\u9645\u5c4f\u5e55\u4e00\u6837\u3002\u53e6\u5916\u4e00\u8fb9\u76f8\u5e94\u7b49\u6bd4\u4f8b\u7f29\u653e\uff0c\u53ef\u80fd\u5c0f\u4e8e\u5c4f\u5e55\u5927\u5c0f\u800c\u51fa\u73b0\u9ed1\u8fb9\uff0c\u4e5f\u53ef\u80fd\u5927\u4e8e\u5c4f\u5e55\u800c\u88ab\u88c1\u526a\uff0c\u8fd9\u4e9b\u53ef\u80fd\u90fd\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\uff0c\u540e\u9762\u4f1a\u8bf4\u600e\u4e48\u89e3\u51b3\u3002\n\ncocos creator 2.1.0\u7248\u672c\u9ed8\u8ba4Canvas\u4e0b\u9762\u6709Main Camera\u5b50\u8282\u70b9\uff0c\u5176\u4ed6\u5b50\u8282\u70b9\u662f\u6a21\u7248\u793a\u4f8b\uff0c\u76f4\u63a5\u5220\u9664\u3002\u4e00\u822c\u6211\u8fd8\u4f1a\u7ed9Canvas\u6dfb\u52a0\u4e24\u4e2a\u5b50\u8282\u70b9\uff0c\u4e00\u4e2asceneLayer\u4f5c\u4e3a\u573a\u666f\u6839\u8282\u70b9\uff0c\u4e00\u4e2apopupLayer\u4f5c\u4e3a\u5f39\u7a97\u6839\u8282\u70b9\u3002\u56e0\u4e3a\u573a\u666f\u6211\u4eec\u5b81\u613f\u8d85\u6846\u88ab\u88c1\u526a\uff0c\u4e5f\u4e0d\u5e0c\u671b\u770b\u5230\u9ed1\u5e95\uff0c\u5f39\u7a97\u5219\u5e0c\u671b\u80fd\u5b8c\u6574\u663e\u793a\uff0c\u4f46\u5f15\u64ce\u672c\u8eab\u662f\u7edf\u4e00\u5904\u7406\u7684\u3002\u5206\u5f00\u4e24\u4e2a\u4e0d\u540c\u7684\u6839\u8282\u70b9\uff0c\u5728\u52a0\u8f7d\u540e\u6839\u636e\u5c4f\u5e55\u5927\u5c0f\u5355\u72ec\u8c03\u6574\u573a\u666f\u6839\u8282\u70b9sceneLayer\u7684\u7f29\u653e\u8ba9\u4ed6\u94fa\u6ee1\u5c4f\u5e55\u3002\u5bf9\u4e8e\u5fae\u4fe1\u5c0f\u6e38\u620f\u4e4b\u7c7b\uff0c\u5355\u72ec\u8c03\u6574\u4e0b\u79fb\u5f39\u7a97\u6839\u8282\u70b9popupLayer\uff0c\u907f\u514d\u4e0e\u5fae\u4fe1\u5c0f\u6e38\u620f\u7684\u5173\u95ed\u6309\u94ae\u91cd\u5408\u3002\n\n\u7136\u540e\uff0c\u5c31\u53ef\u4ee5\u5f00\u59cb\u5199\u5165\u53e3\u811a\u672c\uff0c\u628a\u5b83\u6302\u5230Canvas\u8282\u70b9\u3002cocos creator\u91c7\u7528\u7ec4\u4ef6\u6a21\u5f0f\uff0c\u6bcf\u4e2a\u8282\u70b9\u90fd\u53ef\u4ee5\u6302\u8f7d\u4e0d\u540c\u7684\u7ec4\u4ef6\uff0c\u5305\u62ec\u81ea\u5df1\u5f00\u53d1\u7684\u811a\u672c\u7ec4\u4ef6\u3002\u65b0\u5efa\u4e00\u4e2aStartCtrl.ts\uff0c\u6240\u6709\u8ddf\u754c\u9762\u8282\u70b9\u5173\u8054\u7684\u811a\u672c\u7c7b\u90fd\u7ee7\u627f\u81eacc.Component\uff0c\u7531\u4e8ecreator\u662f\u4f7f\u7528\u88c5\u9970\u5668\u8bed\u6cd5\u6765\u68c0\u67e5\u5c5e\u6027\u7684\uff0c\u6240\u4ee5\u8981\u7528\u5230@property\u548c@class\u88c5\u9970\u5668\uff0c\u5176\u4e2d@property\u7528\u4e8e\u58f0\u660e\u7f16\u8f91\u5668\u53ef\u4ee5\u68c0\u67e5\u5230\u7684\u5c5e\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u58f0\u660e\u4e24\u4e2a\u5c5e\u6027\uff0csceneLayer\u548cpopupLayer\u5c5e\u6027\uff0c\u7528\u4e8e\u5173\u8054\u754c\u9762\u7684\u573a\u666f\u6839\u8282\u70b9\u548c\u5f39\u7a97\u6839\u8282\u70b9\uff0c@class\u7528\u4e8e\u58f0\u660e\u7f16\u8f91\u5668\u53ef\u4ee5\u6302\u5230\u8282\u70b9\u7684\u7c7b\u3002cc.Component\u5b9a\u4e49\u4e86\u4e00\u7cfb\u5217\u751f\u547d\u5468\u671f\u65b9\u6cd5\uff0c\u5728\u8282\u70b9\u4e0d\u540c\u751f\u547d\u5468\u671f\u4f1a\u8c03\u7528\u3002\u4e0b\u9762\u662f\u5165\u53e3\u811a\u672c\u7684\u7b80\u5355\u5b9e\u73b0\u3002\n\/\/\u6e38\u620f\u5165\u53e3\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class StartCtrl extends cc.Component {\n\n    @property(cc.Node)\n    popupLayer: cc.Node = null;\n\n    @property(cc.Node)\n    sceneLayer: cc.Node = null;\n\n    start () {\n\u3000\u3000\u3000\u3000\/\/ TODO Add Start Code\n    }\n}\n\u5728\u7f16\u8f91\u5668\u9009\u62e9Canvas\u8282\u70b9\uff0c\u5728\u5c5e\u6027\u9762\u677f\u70b9\u51fb\u201c\u6dfb\u52a0\u7ec4\u4ef6\u201d\uff0c\u9009\u62e9\u7528\u6237\u811a\u672c\u7ec4\u4ef6\uff0c\u9009\u62e9StartCtrl\uff0c\u62d6sceneLayer\u548cpopupLayer\u4e24\u4e2a\u8282\u70b9\u5230\u5c5e\u6027\u9762\u677f\u5bf9\u5e94\u5c5e\u6027\uff0c\u8fd9\u6837\u5c31\u5173\u8054\u597d\u5165\u53e3\u811a\u672c\u3002\u542f\u52a8\u6e38\u620f\u540e\uff0cCanvas\u7684\u751f\u547d\u5468\u671f\u5c31\u4f1a\u89e6\u53d1StartCtrl\u91cc\u5bf9\u5e94\u7684\u65b9\u6cd5\uff0cStartCtrl\u91cc\u7684sceneLayer\u548cpopupLayer\u5c5e\u6027\u5df2\u88ab\u8d4b\u503c\u4e3aCanvas\u5bf9\u5e94\u7684\u5b50\u8282\u70b9\u3002\u540e\u9762\u6211\u4eec\u4f1a\u7ee7\u7eed\u8bb2\u89e3\u5982\u4f55\u4f7f\u7528\u8fd9\u4e24\u4e2a\u5c5e\u6027\u5bf9\u754c\u9762\u8fdb\u884c\u5206\u5c42\u7ba1\u7406\u3002\n\n\u73b0\u5728\uff0c\u6211\u4eec\u5148\u770b\u770b\u600e\u6837\u5236\u4f5c\u754c\u9762\u3002\u6211\u4eec\u53ef\u4ee5\u628a\u6bcf\u4e00\u4e2a\u754c\u9762\u90fd\u505a\u6210\u4e00\u4e2aprefab\u9884\u5236\u4f53\u3002\u540c\u6837\u5728assets\u76ee\u5f55\u4e0b\uff0c\u4f1a\u770b\u5230\u4e00\u4e2a\u53ebTexture\u7684\u76ee\u5f55\uff0c\u5148\u628a\u5b83\u6539\u6210resources\uff0c\u56e0\u4e3acocos\u52a0\u8f7d\u8d44\u6e90\u65f6\u5bf9resources\u6709\u7279\u6b8a\u5904\u7406\uff0c\u540e\u9762\u4f1a\u8bb2\u89e3\u3002\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u518d\u5efa\u4e00\u4e2a\u76ee\u5f55\u53ebprefabs\uff0cassets\/resources\/prefabs\u4e13\u95e8\u7528\u6765\u5b58\u653e\u754c\u9762\u7684\u9884\u5236\u4f53\u3002\n\n\u5236\u4f5c\u9884\u5236\u4f53\u7684\u65b9\u6cd5\u5f88\u7b80\u5355\u3002\u5148\u53cc\u51fbscene\/main.fire\u6253\u5f00\uff0c\u5728Canvas\u8282\u70b9\u53f3\u952e\u65b0\u5efa\u7a7a\u767d\u8282\u70b9\uff0c\u5c5e\u6027\u9762\u677f\u5c06\u65b0\u8282\u70b9\u540d\u5b57\u6539\u4e3aTestView\uff0c\u62d6\u52a8\u8be5\u8282\u70b9\u5230\u8d44\u6e90\u7ba1\u7406\u5668\u9762\u677f\u7684assets\/resources\/prefabs\u76ee\u5f55\u3002\u8fd9\u6837\u4e00\u4e2a\u9884\u5236\u4f53TestView\u5c31\u751f\u6210\u4e86\uff0c\u8fd9\u65f6\u53ef\u4ee5\u5728main.fire\u7684Canvas\u8282\u70b9\u4e2d\u5220\u9664TestView\u8fd9\u4e2a\u5b50\u8282\u70b9\uff0c\u6211\u4eec\u5df2\u7ecf\u4e0d\u9700\u8981\u8fd9\u4e2a\u5b50\u8282\u70b9\u3002\n\n\u5728\u8d44\u6e90\u7ba1\u7406\u5668\u76ee\u5f55\u627e\u5230assets\/resources\/prefabs\u76ee\u5f55\uff0c\u53cc\u51fbTestView.prefab\u6253\u5f00\u8fd9\u4e2a\u9884\u5236\u4f53\uff0c\u53ef\u4ee5\u770b\u5230\u91cc\u9762\u662f\u7a7a\u7684\uff0c\u53ef\u4ee5\u5148\u8bbe\u7f6e\u6839\u8282\u70b9\u7684Size\uff0c\u8fd9\u5c31\u662f\u8fd9\u4e2a\u754c\u9762\u7684\u8bbe\u8ba1\u5927\u5c0f\u3002\u7136\u540e\u53ef\u4ee5\u5f00\u59cb\u7528cocos\u7684ui\u7ec4\u4ef6\u3001\u6e32\u67d3\u7ec4\u4ef6\u5e03\u5c40\u754c\u9762\uff0ccocos\u7684ui\u7ec4\u4ef6\u3001\u6e32\u67d3\u7ec4\u4ef6\u4f7f\u7528\u53c2\u770bcocos\u5b98\u65b9\u6587\u6863\u3002\n\n\n\u7136\u540e\uff0c\u540c\u6837\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u5199\u8fd9\u4e2a\u754c\u9762\u7684\u811a\u672cTestViewCtrl.ts\uff0c\u63a7\u5236\u754c\u9762\u903b\u8f91\u548c\u5237\u65b0\u3002\u8fd9\u4e2a\u811a\u672c\u8fd8\u662f\u7ee7\u627fcc.Component\uff0c\u5b9a\u4e49\u5bf9\u5e94\u7684cc.Label\u7b49\u7c7b\u578b\u7684\u5c5e\u6027\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u628a\u754c\u9762\u7684\u5143\u7d20\u5173\u8054\u5230\u811a\u672c\uff0c\u901a\u8fc7\u811a\u672c\u6765\u5237\u65b0\u3002\n\/\/\u6d4b\u8bd5\u754c\u9762\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class TestViewCtrl extends cc.Component {\n\n    @property(cc.Label)\n    label: cc.Label = null;\/\/ LIFE-CYCLE CALLBACKS:\n\n    \/\/ onLoad () {}\n\n    start () {\n\u3000\u3000\u3000\u3000this.label.string = \"hello\";\n    }\n\n    \/\/ update (dt) {}\n}\n\u6253\u5f00\u56de\u521a\u624d\u90a3\u4e2a\u9884\u5236\u4f53\uff0c\u9009\u62e9\u6839\u8282\u70b9\uff0c\u5728\u5c5e\u6027\u9762\u677f\u9009\u62e9\u6dfb\u52a0\u7ec4\u4ef6TestViewCtrl\uff0c\u5e76\u5c06\u5bf9\u5e94ui\u7ec4\u4ef6\u62d6\u5230\u811a\u672c\u7ec4\u4ef6\u7684\u5c5e\u6027\u4e0a\u8fdb\u884c\u5173\u8054\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7TestViewCtrl\u63a7\u5236\u8fd9\u4e2a\u754c\u9762\u4e86\u3002\n\n\u8981\u663e\u793a\u8fd9\u4e2a\u754c\u9762\uff0c\u9996\u5148\u8981\u52a0\u8f7dprefab\u3002cocos\u63d0\u4f9b\u4e86cc.loader.loadRes\u63a5\u53e3\uff0c\u7c7b\u578b\u4f20cc.Prefab\uff0c\u52a0\u8f7d\u6210\u529f\u540e\u901a\u8fc7cc.instantiate\u63a5\u53e3\u628a\u9884\u5236\u4f53\u5b9e\u4f8b\u51fa\u4e00\u4e2acc.Node\uff0ccocos\u7684\u754c\u9762\u5e03\u5c40\u662f\u57fa\u4e8e\u7ec4\u5408\u6a21\u5f0f\u7684\u4e00\u68f5\u6811\uff0ccc.Node\u901a\u8fc7addChild\u628a\u5176\u4ed6cc.Node\u6dfb\u52a0\u5230\u754c\u9762\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u901a\u8fc7popupLayer.addChild\u628a\u8fd9\u4e2a\u754c\u9762\u653e\u5230\u5c4f\u5e55\uff0c\u8fd9\u4e9b\u4ee3\u7801\u53ef\u4ee5\u5199\u5728\u5165\u53e3\u811a\u672cStartCtrl\u7684start\u65b9\u6cd5\u91cc\u3002\u53ef\u4ee5\u901a\u8fc7cc.Node.getComponent\u83b7\u53d6TestViewCtrl\u7684\u5b9e\u4f8b\u6765\u64cd\u4f5c\u754c\u9762\u3002\u4e0d\u8fc7\uff0c\u6211\u4e00\u822c\u662f\u901a\u8fc7cc.Component\u7684\u751f\u547d\u5468\u671f\u548c\u6d88\u606f\u6765\u5b9e\u73b0\u754c\u9762\u66f4\u65b0\uff0c\u964d\u4f4e\u8026\u5408\uff0c\u540e\u9762\u4f1a\u8be6\u7ec6\u4ecb\u7ecd\u8fd9\u79cd\u65b9\u5f0f\u3002\n\/\/\u6e38\u620f\u5165\u53e3\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class StartCtrl extends cc.Component {\n\n    @property(cc.Node)\n    popupLayer: cc.Node = null;\n\n    @property(cc.Node)\n    sceneLayer: cc.Node = null;\n\n    start () {\n\u3000\u3000\u3000\u3000cc.loader.loadRes(\"prefabs\/TestView\", cc.Prefab, (err, result) =&gt; {\n                if (!err) {\n                    return;\n                }\n\n                let prefab = result as cc.Prefab;\n                let view = cc.instantiate(prefab);\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 \/\/ let ctrl = view.getComponent(TestViewCtrl);\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 this.popupLayer.addChild(view);\n            });\n    }\n}\n\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u600e\u6837\u5efa\u7acb\u6e38\u620f\u5165\u53e3\uff0c\u600e\u6837\u5236\u4f5c\u3001\u52a0\u8f7d\u3001\u663e\u793a\u754c\u9762\uff0c\u4e0b\u4e00\u7ae0\u5c06\u8bb2\u89e3\u600e\u6837\u5bf9\u5f39\u7a97\u5206\u5c42\u7ba1\u7406\u3002","categories":"\u6559\u7a0b","tags":[""]},{"title":"\u8d44\u6e90\u7ba1\u7406","url":"https:\/\/naka1205.github.io\/cocos\/p\/30A5A7449E53FF36.html","content":"\u8d44\u6e90\u7ba1\u7406\n\u5728\u521d\u8bc6\u7bc7\uff0c\u6211\u4ecb\u7ecd\u8fc7\u600e\u6837\u52a0\u8f7dprefab\u3002cocos\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u7684\u52a0\u8f7d\u63a5\u53e3\uff0c\u5305\u62eccc.loader.load\uff0ccc.loader.loadRes\uff0ccc.loader.loadResArray\uff0ccc.loader.loadResDir\u3002\nstatic load(resources: string|string[]|{uuid?: string, url?: string, type?: string}, completeCallback?: Function): void;\n\nstatic loadRes(url: string, type: typeof cc.Asset, completeCallback: (error: Error, resource: any) =&gt; void): void;\n\nstatic loadResArray(url: string[], type: typeof cc.Asset, progressCallback: (completedCount: number, totalCount: number, item: any) =&gt; void, completeCallback: ((error: Error, resource: any[]) =&gt; void)|null): void;\n\nstatic loadResDir(url: string, type: typeof cc.Asset, progressCallback: (completedCount: number, totalCount: number, item: any) =&gt; void, completeCallback: ((error: Error, resource: any[], urls: string[]) =&gt; void)|null): void;\n\n\u8fd9\u4e9b\u63a5\u53e3\u9664\u4e86\u52a0\u8f7d\u8d44\u6e90\u5916\uff0c\u4e5f\u8d1f\u8d23\u8d44\u6e90\u7ba1\u7406\u3002\u6240\u4ee5\uff0c\u5728\u754c\u9762\u88ab\u9500\u6bc1\u65f6\uff0c\u5982\u679c\u5728cc.loader\u91cc\u8fd8\u6709\u8be5\u8d44\u6e90\uff0c\u8d44\u6e90\u662f\u4e0d\u4f1a\u91ca\u653e\u7684\u3002\u5bf9\u4e8e\u8d44\u6e90\u7684\u7ba1\u7406\uff0c\u6709\u4e24\u79cd\u65b9\u5f0f\uff0c\u4e00\u79cd\u662f\u8d44\u6e90\u52a0\u8f7d\u540e\uff0ccc.loader\u4e0d\u7ba1\u7406\u8d44\u6e90\uff0c\u901a\u8fc7\u754c\u9762\u7684\u5f15\u7528\u6765\u786e\u5b9a\u662f\u5426\u9500\u6bc1\u8d44\u6e90\u3002\u4e00\u79cd\u662fcc.loader\u7ba1\u7406\u8d44\u6e90\uff0c\u754c\u9762\u4f7f\u7528\u8d44\u6e90\uff0c\u5728\u6a21\u5757\u9000\u51fa\u65f6\uff0c\u901a\u8fc7cc.loader\u9500\u6bc1\u8d44\u6e90\u3002\u6211\u504f\u5411\u4e8e\u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff0c\u8fd9\u6837\u907f\u514d\u4f9d\u8d56\u5185\u5b58gc\uff0c\u8d44\u6e90\u53ef\u4ee5\u5f97\u5230\u5373\u65f6\u91ca\u653e\u3002\u4e3a\u4e86\u907f\u514d\u9519\u8bef\u91ca\u653e\u8d44\u6e90\uff0c\u5728\u8d44\u6e90\u7ba1\u7406\u6a21\u5757\u5bf9\u52a0\u8f7d\u7684\u8d44\u6e90\u8bbe\u7f6e\u5f15\u7528\u8ba1\u6570\uff0c\u5f15\u7528\u8ba1\u6570\u4e3a0\u65f6\u624d\u5b9e\u9645\u9500\u6bc1\u3002\n\u4e0b\u9762\u8bf4\u8bf4\u8fd9\u51e0\u4e2a\u63a5\u53e3\u7684\u4f7f\u7528\u573a\u666f\uff1a\n\ncc.loader.load\u7528\u4e8e\u52a0\u8f7d\u7b2c\u4e09\u65b9\u8fdc\u7a0b\u8d44\u6e90\uff0c\u5728\u6e38\u620f\u4e2d\u4e00\u822c\u7528\u4e8e\u52a0\u8f7d\u7b2c\u4e09\u65b9\u5e73\u53f0\u7684\u5934\u50cf\u8d44\u6e90\uff0c\u5982\u679c\u8be5\u8d44\u6e90\u7684\u94fe\u63a5\u6ca1\u6709\u6587\u4ef6\u540e\u7f00\u540d\uff0c\u9700\u8981\u52a0\u53c2\u6570{type:\"png\"}\u3002\ncc.loader.loadRes\u7528\u4e8e\u52a0\u8f7dassets\/resources\u76ee\u5f55\u4e0b\u5355\u4e2a\u8d44\u6e90\ncc.loader.loadResArray\u7528\u4e8e\u6279\u91cf\u52a0\u8f7dassets\/resources\u76ee\u5f55\u4e0b\u8d44\u6e90\uff0c\u6bd4\u8f83\u9002\u5408\u4e8e\u8fdb\u5ea6\u6761\u52a0\u8f7d\u754c\u9762\uff0c\u901a\u8fc7\u8fdb\u5ea6\u53d8\u5316\u66f4\u65b0\u8fdb\u5ea6\u6761\u3002\ncc.loader.loadResDir\u7528\u4e8e\u52a0\u8f7dassets\/resources\u76ee\u5f55\u4e0b\u5355\u4e2a\u76ee\u5f55\u7684\u8d44\u6e90\uff0c\u4e00\u822c\u6211\u4f1a\u628a\u5355\u4e2aspine\u9aa8\u9abc\u52a8\u753b\u653e\u5728\u4e00\u4e2a\u76ee\u5f55\uff0c\u628a\u4e00\u4e2a\u754c\u9762\u7684\u8d44\u6e90\u653e\u5728\u4e00\u4e2a\u76ee\u5f55\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u63a5\u53e3\u52a0\u8f7d\u5355\u4e2aspine\u52a8\u753b\u6216\u8005\u4e00\u4e2a\u754c\u9762\u7684\u8d44\u6e90\u3002\n\n\u5728\u521d\u8bc6\u7bc7\u63d0\u5230\uff0c\u6211\u4eec\u5efa\u7acbassets\/resources\u76ee\u5f55\u7528\u4e8e\u5b58\u653e\u8d44\u6e90\uff0c\u76ee\u7684\u662f\u53ef\u4ee5\u901a\u8fc7\u4e0a\u8ff0\u9664\u4e86cc.loader.load\u5916\u7684\u63a5\u53e3\u52a0\u8f7d\u8d44\u6e90\uff0c\u7b80\u5316\u4f7f\u7528\u3002\n\n\u8d44\u6e90\u52a0\u8f7d\u7ba1\u7406\u6a21\u5757\uff0c\u53ef\u4ee5\u5212\u5206\u4e3aResLoader\u3001ViewLoader\u3002\u5176\u4e2dResLoader\u8d1f\u8d23\u57fa\u7840\u8d44\u6e90\u52a0\u8f7d\uff0c\u53e6\u5916\u63d0\u4f9b\u8d85\u65f6\u3001\u91cd\u8bd5\u673a\u5236\u3002ViewLoader\u8d1f\u8d23\u5bf9\u52a0\u8f7d\u7684prefab\u3001\u91cd\u7528\u754c\u9762\u7684node\u8fdb\u884c\u7f13\u5b58\u7ba1\u7406\u3002\u8fd9\u7c7b\u5de5\u5177\u6027\u7684\u7c7b\uff0c\u6211\u90fd\u4e60\u60ef\u505a\u6210\u5355\u4f8b\uff0c\u4e00\u6765\u6e38\u620f\u91cc\u53ea\u9700\u8981\u4e00\u4e2a\u5bf9\u8c61\uff0c\u53e6\u5916\u5355\u4f8b\u6709\u5229\u4e8e\u8fd9\u4e9b\u5bf9\u8c61\u53ef\u4ee5\u5168\u5c40\u8bbf\u95ee\u3002\nResLoader\uff0c\u5c01\u88c5cc.loader\u4e0a\u8ff0\u51e0\u4e2a\u63a5\u53e3\uff0c\u4ee5\u53ca\u5bf9\u5e94\u7684\u91ca\u653e\u63a5\u53e3\u3002\n\u8d85\u65f6\u5b9e\u73b0\uff1a\u8bbe\u7f6e\u56de\u8c03\u63a7\u5236\u53d8\u91cf\uff0csettimeout\u56de\u8c03\u4e2d\u8bbe\u7f6e\u53d8\u91cf\uff0c\u5e76\u8c03\u7528\u8d85\u65f6\u56de\u8c03\uff0c\u5728\u6210\u529f\u5931\u8d25\u5904\u7406\u4e2d\u5224\u65ad\u53d8\u91cf\u662f\u5426\u89e6\u53d1\u6210\u529f\u5931\u8d25\u7684\u56de\u8c03\u3002\u7531\u4e8ecc.loader\u672c\u8eab\u6709\u505a\u8d44\u6e90\u7ba1\u7406\uff0c\u6240\u4ee5\u4e0b\u6b21\u8c03\u7528\u52a0\u8f7d\u65f6\u5982\u679c\u5df2\u7ecf\u901a\u8fc7cc.loader\u6b63\u5728\u52a0\u8f7d\u548c\u6210\u529f\u52a0\u8f7d\u7684\u8d44\u6e90\u4e0d\u4f1a\u91cd\u590d\u52a0\u8f7d\u3002\n\u91cd\u8bd5\u5b9e\u73b0\uff1a\u901a\u8fc7\u53d8\u91cf\u8bb0\u5f55\u52a0\u8f7d\u6b21\u6570\uff0c\u5728\u5931\u8d25\u548c\u8d85\u65f6\u5904\u7406\u4e2d\u5224\u65ad\u662f\u5426\u8fbe\u5230\u91cd\u8bd5\u6b21\u6570\uff0c\u672a\u8fbe\u5230\u5219\u91cd\u65b0\u52a0\u8f7d\u3002\npublic static loadRes(url: string, type: typeof cc.Asset, completeCallback: (error: Error, resource: any) =&gt; void): void {\n  let count = ResLoader.retryCount + 1;\n  let hasCb = false;\n  \/\/ timeout\n  let timer = setTimeout(() =&gt; {\n      hasCb = true;\n      completeCallback &amp;&amp; completeCallback({\n          name: \"timeout\",\n          message: \"timeout\",\n      }, null);\n  }, ResLoader.timeout);\n  \/\/ real load\n  let realLoad = function() {\n      count--;\n      \/\/ load\n      cc.loader.loadRes(url, type, (err, result) =&gt; {\n          if (!err || count &lt;= 0) {\n              clearTimeout(timer);\n              !hasCb &amp;&amp; completeCallback &amp;&amp; completeCallback(err, result);\n              return;\n          }\n\n          realLoad();\n      });\n  }; \n  realLoad();\n}\nViewLoader\uff0c\u8d1f\u8d23prefab\u548c\u91cd\u7528\u754c\u9762node\u7684\u7f13\u5b58\uff0c\u6240\u4ee5\u6bcf\u4e2aprefab\u90fd\u8bbe\u7f6e\u4e00\u4e2a\u5bf9\u5e94\u7684tag\uff0c\u52a0\u8f7d\u7684prefab\u5b58\u653e\u5728Dictionary&lt;number\uff0ccc.Prefab&gt;\u7c7b\u578b\u7684prefabDict\u5c5e\u6027\u4e2d\uff08Dictionary\u53ef\u4ee5\u901a\u8fc7\u4e24\u4e2a\u6570\u7ec4\u5b58\u653ekey-value\u5c01\u88c5\u51fa\u6765\uff09\uff0c\u91cd\u7528\u754c\u9762\u7684node\u5b58\u653e\u5728Dictionary &lt;number\uff0ccc.Node&gt;\u7c7b\u578b\u7684nodeDict\u5c5e\u6027\u4e2d\u3002\nprivate static tag2prefabPathMap: Dictionary&lt;number, string&gt; = new Dictionary&lt;number, string&gt;();\nprivate static tag2prefabMap: Dictionary&lt;number, cc.Prefab&gt; = new Dictionary&lt;number, cc.Prefab&gt;();\nprivate static tag2nodeMap: Dictionary&lt;number, cc.Node&gt; = new Dictionary&lt;number, cc.Node&gt;();\n\u901a\u8fc7ResLoader\u52a0\u8f7dcc.Prefab\u3002cc.instantiate\u5b9e\u4f8b\u51fanode\u8282\u70b9\nlet instantiatePrefab = function(prefab: cc.Prefab) {\n  let node = cc.instantiate(prefab);\n  if (reuse &amp;&amp; !ViewLoader.tag2nodeMap.hasKey(tag)) {\n      ViewLoader.tag2nodeMap.set(tag, node);\n  }\n  cb &amp;&amp; cb(node);\n}","categories":"\u6559\u7a0b","tags":[""]},{"title":"\u5f39\u7a97\u7ba1\u7406","url":"https:\/\/naka1205.github.io\/cocos\/p\/11A6F2117472174E.html","content":"\u5f39\u7a97\u7ba1\u7406\n\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u600e\u6837\u5236\u4f5c\u3001\u52a0\u8f7d\u3001\u663e\u793a\u754c\u9762\u3002\u4f46cocos\u6ca1\u6709\u63d0\u4f9b\u4e00\u4e2a\u5f39\u7a97\u7ba1\u7406\u6a21\u5757\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u591a\u4eba\u5408\u4f5c\u7684\u9879\u76ee\uff0c\u6ca1\u6709\u7edf\u4e00\u7684\u7ba1\u7406\uff0c\u754c\u9762\u5c42\u7ea7\u5bb9\u6613\u6df7\u4e71\u3002\u4f5c\u4e3a\u4e3b\u7a0b\uff0c\u5728\u9879\u76ee\u5f00\u59cb\u5c31\u5e94\u8be5\u5904\u7406\u597d\u8fd9\u4e9b\u95ee\u9898\uff0c\u5c06\u5f39\u7a97\u5212\u5206\u4e3a\u4e0d\u540c\u7684\u5c42\u6b21\uff0c\u4e0d\u540c\u7c7b\u578b\u7684\u4fe1\u606f\u663e\u793a\u5728\u4e0d\u540c\u7684\u5c42\u4e2d\u3002\u4e0b\u9762\u5c06\u8bb2\u89e3\u600e\u6837\u8bbe\u8ba1\u5f39\u7a97\u5806\u6808\u3002\n\u4e00\u822c\u5730\uff0c\u4ece\u4e0b\u5411\u4e0a\uff0c\u6211\u4f1a\u5c06\u5f39\u7a97\u5212\u5206\u4e3a\u4ee5\u4e0b\u5c42\uff1a\n\n\u5185\u5bb9\u5c42\uff0c\u5c55\u793a\u6e38\u620f\u76f8\u5173\u7684\u4fe1\u606f\u754c\u9762\u3002\ntips\u5c42\uff0c\u663e\u793a\u63d0\u793a\u6027\u4fe1\u606f\u754c\u9762\uff0c\u4f8b\u5982\u83b7\u5f97\u7269\u54c1\u7684\u6d6e\u7a97\u3001\u7f51\u7edc\u5f02\u5e38\u7684\u63d0\u793a\u3002\n\u65b0\u624b\u5f15\u5bfc\u5c42\uff0c\u4e3b\u8981\u663e\u793a\u65b0\u624b\u5f15\u5bfc\u7684\u624b\u6307\u3001\u65b0\u624b\u63d0\u793a\u6587\u672c\u6846\u7b49\u3002\nalert\u5c42\uff0c\u4e3b\u8981\u663e\u793a\u7cfb\u7edf\u7ea7\u7684\u4fe1\u606f\u3001\u9519\u8bef\uff0c\u4f8b\u5982\u65ad\u7f51\u3001\u88ab\u8e22\u4e0b\u7ebf\u3002\nloading\u5c42\uff0c\u663e\u793a\u52a0\u8f7d\u52a8\u753b\u3002\n\n\n\u5177\u4f53\u600e\u6837\u5b9e\u73b0\uff1f\u5f39\u7a97\u901a\u5e38\u6709\u7edf\u4e00\u7684\u52a8\u753b\uff0c\u6240\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u754c\u9762\u903b\u8f91\u7684\u57fa\u7c7bViewCtrl\uff0c\u5b9a\u4e49\u4e00\u4e9b\u901a\u7528\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\u3002\u6bcf\u4e2a\u5c42\u4e2d\u53ef\u80fd\u540c\u65f6\u5b58\u5728\u591a\u4e2a\u754c\u9762\uff0c\u6211\u628a\u6bcf\u4e2a\u5c42\u505a\u6210\u7ec4ViewGroup\u3002\u518d\u5199\u4e00\u4e2a\u7c7bPopupCtrl\uff0c\u5bf9\u754c\u9762\u5206\u5c42\uff0c\u5e76\u5bf9\u5916\u63d0\u4f9b\u7f16\u7a0b\u63a5\u53e3\u3002\n\u5148\u6765\u8bf4\u8bf4ViewCtrl\u8fd9\u4e2a\u7c7b\uff0c\u7ee7\u627f\u81eacc.Component\uff0c\u8fd9\u6837\u6211\u4eec\u5199\u7684ViewCtrl\u5b50\u7c7b\u5c31\u53ef\u4ee5\u6302\u8f7d\u5230prefab\u7684\u8282\u70b9\u4e0a\u3002\u5b9a\u4e49\u4e24\u4e2aboolean\u5c5e\u6027\uff1ahasMask\u3001touchOutClose\uff0c\u7528\u4e8e\u63a7\u5236\u662f\u5426\u6709\u7070\u8272\u534a\u900f\u660e\u906e\u7f69\uff0c\u548c\u662f\u5426\u70b9\u51fb\u5f39\u7a97\u5916\u5173\u95ed\u3002\u540e\u9762\u5728\u4ecb\u7ecdViewGroup\u65f6\u4f1a\u4ecb\u7ecd\u600e\u6837\u5b9e\u73b0\u8fd9\u4e24\u4e2a\u529f\u80fd\u3002\ncc.Component\u672c\u8eab\u6709onEnable\uff0conDisable\u4e24\u4e2a\u751f\u547d\u5468\u671f\u65b9\u6cd5\uff0c\u4f46\u6211\u4eec\u5e0c\u671b\u540c\u5c4f\u4e0d\u51fa\u73b0\u592a\u591a\u5f39\u7a97\uff0c\u5f39\u51fa\u65b0\u5f39\u7a97\u65f6\u9690\u85cf\u4e0a\u4e00\u4e2a\u5f39\u7a97\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u9891\u7e41\u8c03\u7528\u3002\u5bf9\u4e8e\u6253\u5f00\u754c\u9762\u65f6\u7684\u5237\u65b0\uff0c\u5728\u754c\u9762\u653e\u5230\u5806\u6808\u65f6\u56de\u8c03\u66f4\u5408\u9002\u3002\u540c\u7406\u5bf9\u91cd\u7528\u7684\u754c\u9762\u7684\u91cd\u7f6e\uff0c\u5728\u754c\u9762\u79fb\u51fa\u5806\u6808\u65f6\u56de\u8c03\u91cd\u7f6e\u3002\u53ef\u4ee5\u5728ViewCtrl\u5b9a\u4e49onAddToStack\u548conRemoveFromStack\u4e24\u4e2a\u751f\u547d\u5468\u671f\u65b9\u6cd5\uff0c\u5728ViewGroup\u91cc\u5728\u5408\u9002\u7684\u65f6\u673a\u89e6\u53d1\uff0c\u540e\u9762\u4f1a\u4ecb\u7ecd\u3002\u518d\u6dfb\u52a0\u4e24\u4e2a\u65b9\u6cd5\uff0conPlayShowAni\uff0conPlayHideAni\uff0c\u5728\u8fd9\u91cc\u53ef\u4ee5\u5b9e\u73b0\u7edf\u4e00\u7684\u5f39\u7a97\u52a8\u753b\u3002\u5b50\u7c7b\u7684\u7279\u6b8a\u663e\u793a\u548c\u5173\u95ed\u52a8\u753b\u7531\u5b50\u7c7b\u91cd\u5199\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u5b9e\u73b0\u3002\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u4e5f\u7531ViewGroup\u5728\u5408\u9002\u7684\u65f6\u673a\u89e6\u53d1\u3002\n\/\/\u754c\u9762\u57fa\u7c7b\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class ViewCtrl extends cc.Component {\n\n    @property\n    hasMask: boolean = true;\n\n    @property\n    touchOutClose: boolean = false;\n\n    public onAddToStack(): void {\n     }\n\n     public onRemoveFromStack(): void {\n     }\n\n     public onPlayShowAni(): void {\n     }\n\n     public onPlayHideAni(): void {\n     }\n}\n\u63a5\u4e0b\u6765\u662fViewGroup\u8fd9\u4e2a\u7c7b\uff0c\u5b83\u4ee3\u8868\u4e00\u4e2a\u5f39\u7a97\u5c42\uff0c\u4e5f\u7ee7\u627f\u81eacc.Component\uff0c\u5b83\u7684node\u53ef\u4ee5\u6dfb\u52a0\u5230PopupCtrl\u7684node\u4e0a\u4ece\u800c\u5c55\u793a\u8fd9\u4e2a\u5f39\u7a97\u5c42\u3002\u5b83\u5e94\u8be5\u6709\u81ea\u5df1\u7684maskLayer\u3001blockLayer\uff0c\u7528\u4e8e\u663e\u793a\u7070\u8272\u534a\u900f\u660e\u906e\u7f69\uff0c\u548c\u5c4f\u853d\u4e0b\u5c42\u754c\u9762\u7684\u89e6\u5c4f\u4e8b\u4ef6\u3002\u5f53\u7136\uff0c\u50cftips\u5c42\uff0c\u6211\u4eec\u4e0d\u5e0c\u671b\u5c4f\u853d\u4e0b\u5c42\u754c\u9762\u7684\u89e6\u5c4f\u4e8b\u4ef6\uff0c\u53ef\u4ee5\u63d0\u4f9b\u63a5\u53e3\u6765\u63a7\u5236\u8fd9\u4e24\u4e2alayer\u662f\u5426\u751f\u6548\u3002\nViewGroup\u6700\u91cd\u8981\u7684\u4f5c\u7528\u662f\u7ba1\u7406\u4e00\u5c42\u7684\u5f39\u7a97\u3002\u6240\u4ee5\u5b83\u5e94\u8be5\u6709\u4e00\u4e2aArray&lt;ViewCtrl&gt;\u7c7b\u578b\u7684viewArr\u5c5e\u6027\u3002\u57fa\u672c\u7684\u64cd\u4f5c\u5305\u62ec:\n\/\/\u754c\u9762\u7ec4\nexport default class ViewGroup extends cc.Component {\n\n     private maskLayer: cc.Node = null;\n     private blockLayer: cc.Node = null;\n     private viewArr: Array&lt;ViewCtrl&gt; = [];\n\n     public pushView(ctrl: ViewCtrl, hideOld: boolean): void {\n     }\n\n     public popView(cleanup: boolean): void {\n     }\n\n     public insertView(ctrl: ViewCtrl): void {\n     }\n\n     public removeView(ctrl: ViewCtrl): void {\n     }\n\n     public pushViews(ctrls: Array&lt;ViewCtrl&gt;, hideOld: boolean): void {\n     }\n\n     public removeAllViews(cleanup: boolean): void {\n     }\n\n     public lastView(): ViewCtrl {\n     }\n\n     public getViewByName(name: string): ViewCtrl {\n     }\n\n     public getViewCount(): number {\n     }\n\n     public isEmpty(): boolean {\n     }\n}\n\u5176\u4e2dpushView\u3001insertView\u3001pushViews\u4f1a\u5c06\u5bf9\u5e94ViewCtrl\u653e\u5165viewArr\uff0c\u5e76\u89e6\u53d1ViewCtrl.onAddToStack\u3002\u901a\u8fc7ViewGroup.node.addChild\u5c06ViewCtrl.node\u6dfb\u52a0\u4e3a\u5b50\u8282\u70b9\u5c06\u5bf9\u5e94\u754c\u9762\u663e\u793a\u51fa\u6765\u3002\u5177\u4f53\u662f\u5426\u8981\u6dfb\u52a0\u5230\u754c\u9762\u8981\u770b\u662f\u5426\u5728hideOld\u7684\u754c\u9762\u4e0b\u9762\u3002pushViews\u4e3b\u8981\u662f\u4e3a\u81ea\u52a8\u5f39\u7a97\u8bbe\u8ba1\u7684\uff0c\u4f8b\u5982\u767b\u5f55\u540e\u81ea\u52a8\u663e\u793a\u516c\u544a\u3001\u7b7e\u5230\u7b49\uff0c\u5173\u95ed\u4e00\u4e2a\u81ea\u52a8\u6253\u5f00\u4e0b\u4e00\u4e2a\u3002\npopView\u3001removeView\u3001removeAllViews\u901a\u8fc7ViewCtrl.node.removeFromParent\u5c06ViewCtrl.node\u79fb\u51fa\u754c\u9762\uff0c\u540c\u65f6\u5c06ViewCtrl\u79fb\u51faviewArr\uff0c\u5e76\u89e6\u53d1ViewCtrl.onRemoveFromStack\u3002pushView\u3001popView\u8fd8\u4f1a\u89e6\u53d1onPlayShowAni\uff0conPlayHideAni\u8fd9\u4e24\u4e2a\u751f\u547d\u5468\u671f\u65b9\u6cd5\u3002\n\u73b0\u5728\u6765\u8bf4\u8bf4PopupCtrl\u8fd9\u4e2a\u7c7b\uff0c\u5b83\u4e5f\u7ee7\u627f\u81eacc.Component\uff0c\u53ef\u4ee5\u76f4\u63a5\u6302\u8f7d\u5230prefab\u7684\u8282\u70b9\u4e0a\uff0c\u5728\u4ecb\u7ecd\u6e38\u620f\u5165\u53e3\u65f6\u6211\u4eec\u7ed9Canvas\u6dfb\u52a0\u4e86popupLayer\u5b50\u8282\u70b9\uff0c\u901a\u8fc7\u6dfb\u52a0\u7ec4\u4ef6\u5c06PopupCtrl\u6302\u4e0a\u53bb\u3002PopupCtrl\u8981\u5b9e\u73b0\u5206\u5c42\uff0c\u5b83\u6709Array&lt;ViewGroup&gt;\u7c7b\u578b\u7684groupArr\u5c5e\u6027\u3002\u5728onLoaded\u751f\u547d\u5468\u671f\u65b9\u6cd5\u91cc\u6309\u5f39\u7a97\u5c42\u987a\u5e8f\uff0c\u901a\u8fc7PopupCtrl.addChild\u6dfb\u52a0\u5bf9\u5e94\u7684\u5f39\u7a97\u5c42\u3002PopupCtrl\u63d0\u4f9b\u8ddfViewGroup\u7c7b\u4f3c\u7684\u63a5\u53e3\uff0c\u4e0d\u540c\u7684\u662fPopupCtrl\u7684pushView\u3001insertView\u3001pushViews\u63d0\u4f9blayer\u53c2\u6570\uff0c\u7528\u4e8e\u6307\u5b9a\u5f39\u7a97\u6dfb\u52a0\u7684\u5c42\u3002\nenum PopupLayer {\n    CONTENT = 0,\n    TIPS,\n    GUIDE,\n    ALERT,\n    LOADING\n}","categories":"\u6559\u7a0b","tags":[""]},{"title":"\u7f51\u7edc\u901a\u4fe1","url":"https:\/\/naka1205.github.io\/cocos\/p\/BFFA75863D9BB58A.html","content":"\u7f51\u7edc\u901a\u4fe1\n\u524d\u9762\u5df2\u7ecf\u4ecb\u7ecd\u600e\u6837\u52a0\u8f7d\u8d44\u6e90\u3001\u7ba1\u7406\u5f39\u7a97\u3002\u5f00\u53d1\u4e00\u4e2a\u7f51\u7edc\u6e38\u620f\uff0c\u96be\u514d\u8981\u5904\u7406\u7f51\u7edc\u901a\u4fe1\u3002\u6709\u51e0\u70b9\u95ee\u9898\u9700\u8981\u6ce8\u610f\uff1a\n\n\u670d\u52a1\u7aef\u4e3a\u4e86\u5feb\u901f\u5f00\u53d1\u53ef\u80fd\u524d\u671f\u4f7f\u7528http\u901a\u4fe1\uff0c\u540e\u9762\u518d\u6539\u6210websocket\/socket\u3002\n\u540c\u65f6\u5b58\u5728http\u548cwebsocket\/socket\u901a\u4fe1\n\u901a\u4fe1\u6570\u636e\u683c\u5f0f\u53ef\u80fd\u9700\u8981\u968f\u65f6\u66ff\u6362\u4e3ajson\u6216protocol buffer\uff0c\u53ef\u80fd\u9700\u8981\u6dfb\u52a0\u989d\u5916\u5934\u90e8\u3002\n\u5728\u65b0\u624b\u5f15\u5bfc\u91cc\u4f7f\u7528\u672c\u5730\u6570\u636e\u505a\u6a21\u62df\uff0c\u8bf7\u6c42\u4e0d\u9700\u8981\u53d1\u9001\u7ed9\u540e\u7aef\u3002\n\u91cd\u8fde\u540e\u6570\u636e\u7b80\u5355\u540c\u6b65\n\n\u9488\u5bf9\u7b2c\u4e00\u3001\u4e8c\u4e2a\u95ee\u9898\uff0c\u6211\u5728\u8bbe\u8ba1\u901a\u4fe1\u6a21\u5757\u65f6\u4f1a\u8003\u8651\u5c06\u901a\u4fe1\u5c3d\u91cf\u62bd\u8c61\u4e3a\u7edf\u4e00\u7684\u5bf9\u5916\u63a5\u53e3\uff0c\u5728\u6e38\u620f\u542f\u52a8\u65f6\u901a\u8fc7\u4e0d\u540c\u7684\u9a71\u52a8\u5668\u521b\u5efa\u5b9e\u4f8b\uff08\u5982\u679c\u53ea\u4f7f\u7528\u4e00\u79cd\u901a\u4fe1\u65b9\u5f0f\uff0c\u4f7f\u7528\u5355\u4e00\u5b9e\u4f8b\uff09\u3002\npublic constructor(driver: ConnectDriver) {\n    this._driver = driver;\n}\n\u5148\u5b9a\u4e49\u901a\u7528\u7684\u7f51\u7edc\u901a\u4fe1\u6570\u636e\u7ed3\u6784\u3002\u5176\u4e2d\u8bf7\u6c42\u5206\u4e3a\u6570\u636e\u548c\u63a7\u5236\u4e24\u79cd\u7c7b\u578b\uff0c\u7528\u4e8e\u533a\u5206\u5fc3\u8df3\u3001\u767b\u5f55\u3001\u91cd\u8fde\n\/\/\u8bf7\u6c42\u7c7b\u578b\nexport enum RequestType {\n    DATA = 1,\n    CTRL\n}\n\/\/\u7f51\u7edc\u901a\u4fe1\u6570\u636e\u7ed3\u6784\nexport interface NetData {\n    seq?: number; \/\/ \u5e8f\u5217\u53f7\n    mod: number; \/\/ \u6a21\u5757\n    cmd: number; \/\/ \u547d\u4ee4\n    path?: string; \/\/ \u8def\u5f84\n    data?: any; \/\/ \u6570\u636e\n    tmpData?: any; \/\/ \u6570\u636e\u5904\u7406\u5668\u4e34\u65f6\u6570\u636e\n    status?: number; \/\/\u72b6\u6001\u7801\n    type?: RequestType;  \/\/\u8bf7\u6c42\u7c7b\u578b\n}\n\u7136\u540e\u5b9a\u4e49\u901a\u7528\u7684\u5bf9\u5916\u63a5\u53e3\npublic open(url: string, port: number, isBinary: boolean, timeout: number, retryCount: number, params: any, cb: (succ: boolean) =&gt; void): void {}\npublic close(): number {}\npublic reopen(cb: (succ: boolean) =&gt; void): void {}\npublic sendData(data: NetData, params: HttpReq | any, succCb: (data: NetData) =&gt; void, failedCb: (code: number, reason: string) =&gt; void): void {}\npublic resendNotRecv(): void {}\n\u5176\u4e2dresendNotRecv\u7528\u4e8e\u91cd\u8fde\u540e\u53d1\u9001\u6ca1\u6709\u6536\u5230\u54cd\u5e94\u7684\u5305\uff0c\u540e\u7aef\u6839\u636e\u5e8f\u5217\u53f7\u51b3\u5b9a\u662f\u5426\u5904\u7406\u3002\n\u8fd9\u91cc\u6ca1\u6709\u5bf9\u63a8\u9001\u7684\u5904\u7406\uff0c\u5b9e\u9645\u4e0a\u63a8\u9001\u662f\u63a5\u6536\u5230\u670d\u52a1\u7aef\u6570\u636e\u540e\uff0c\u8c03\u7528\u5e7f\u64ad\u7ed9\u76d1\u542c\u8005\u3002\u4e0b\u9762\u5b9a\u4e49\u76d1\u542c\u8005\n\/\/\u7f51\u7edc\u8fde\u63a5\u4e8b\u4ef6\u76d1\u542c\u63a5\u53e3\nexport interface ConnectEventListener {\n    onOpen(driver: ConnectDriver);\n    onClosed(driver: ConnectDriver);\n    onError(driver: ConnectDriver, msg: string);\n    onSendStart(driver: ConnectDriver);\n    onRecvEnd(driver: ConnectDriver);\n}\n\/\/\u7f51\u7edc\u4e8b\u4ef6\u76d1\u542c\u63a5\u53e3\nexport interface NetEventListener extends ConnectEventListener {\n    onPush(driver: ConnectDriver, data: NetData): void;\n}\n\u5bf9\u5916\u63d0\u4f9b\u6ce8\u518c\u548c\u79fb\u9664\u63a5\u53e3\npublic addEventListener(listener: NetEventListener): void {}\npublic removeEventListener(listener: NetEventListener): void {}\n\u9488\u5bf9\u7b2c\u4e09\u4e2a\u95ee\u9898\uff0c\u9700\u8981\u5b9a\u4e49\u4e00\u4e9b\u9884\u5904\u7406\u5668\uff0c\u5728\u53d1\u9001\u6570\u636e\u524d\u548c\u63a5\u6536\u5230\u6570\u636e\u540e\uff0c\u505a\u62e6\u622a\u9884\u5904\u7406\u3002\n\/\/\u7f51\u7edc\u901a\u4fe1\u6570\u636e\u5904\u7406\u5668\u63a5\u53e3\nexport interface NetDataProcessor {\n    processReqData(data: any): any;\n    processRespData(data: any): any;\n}\n\u5bf9\u5916\u63d0\u4f9b\u6dfb\u52a0\u548c\u79fb\u9664\u63a5\u53e3\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u7075\u6d3b\u5b9a\u4e49\u901a\u4fe1\u6570\u636e\u683c\u5f0f\npublic addDataProcessor(processor: NetDataProcessor): void {}\npublic removeDataProcessor(processor: NetDataProcessor): void {}\n\u9488\u5bf9\u7b2c\u56db\u4e2a\u95ee\u9898\uff0c\u540c\u6837\u662f\u589e\u52a0\u4e00\u4e2a\u7279\u6b8a\u7684\u62e6\u622a\u5668\uff0c\u5728\u8bf7\u6c42\u53d1\u9001\u524d\u5bf9\u5176\u5904\u7406\uff0c\u5982\u679c\u62e6\u622a\u5668\u80fd\u5904\u7406\uff0c\u5c31\u4e0d\u518d\u53d1\u9001\u7ed9\u540e\u7aef\u3002\n\/\/\u6a21\u62df\u670d\u52a1\u5668\u63a5\u53e3\nexport interface SimServer {\n    handleRequest(data: NetData): NetData;\n}\n\u5bf9\u5916\u63d0\u4f9b\u8bbe\u7f6e\u63a5\u53e3\npublic setSimServer(server: SimServer): void {}\n\u9488\u5bf9\u7b2c\u4e94\u4e2a\u95ee\u9898\uff0c\u6240\u6709\u6570\u636e\u8bf7\u6c42\u90fd\u6709\u5e8f\u5217\u53f7\uff0c\u5bf9\u8bf7\u6c42\u8fdb\u884c\u8bb0\u5f55\uff0c\u6ca1\u6709\u54cd\u5e94\u7684\u8bf7\u6c42\u5305\u653e\u5230\u4e00\u4e2a\u961f\u5217\u91cc\uff0c\u91cd\u8fde\u540e\u91cd\u53d1\u8fd9\u4e9b\u5305\u7ed9\u540e\u7aef\u5904\u7406\u3002\npublic resendNotRecv(): void {}\n\u7f51\u7edc\u901a\u4fe1\u5148\u8bf4\u5230\u8fd9\u91cc\uff0c\u4e0b\u4e00\u7bc7\u6211\u4eec\u5c06\u4ecb\u7ecd\u4e0b\u600e\u6837\u8bbe\u8ba1\u65e5\u5fd7\u7cfb\u7edf\u3002","categories":"\u6559\u7a0b","tags":[""]},{"title":"\u65e5\u5fd7\u7cfb\u7edf","url":"https:\/\/naka1205.github.io\/cocos\/p\/37322E7BA0648835.html","content":"\u65e5\u5fd7\u7cfb\u7edf\n\u8fd9\u4e00\u7bc7\u4ecb\u7ecd\u65e5\u5fd7\u7cfb\u7edf\u7684\u8bbe\u8ba1\u3002\u4e00\u822c\u6211\u4eec\u5f00\u53d1\u4e00\u4e2ademo\uff0c\u53ea\u4f1a\u7b80\u5355\u7684\u7528cocos\u63d0\u4f9b\u7684cc.log\u6253\u5370\u4e0b\u65e5\u5fd7\uff0c\u65b9\u4fbf\u8c03\u8bd5\u529f\u80fd\u3002\u4f46\u662f\u8981\u5f00\u53d1\u4e00\u4e2a\u5546\u4e1a\u9879\u76ee\uff0c\u8fd8\u8981\u8003\u8651\u600e\u4e48\u6536\u96c6\u65e5\u5fd7\uff0c\u65b9\u4fbf\u4ea7\u54c1\u4e0a\u7ebf\u540e\u5b9a\u4f4d\u7ebf\u4e0a\u95ee\u9898\u3002\u5982\u679c\u7ebf\u4e0a\u4ea7\u54c1\u8fd0\u884c\u51fa\u5f02\u5e38\u65f6\u80fd\u628a\u5f53\u65f6\u7684\u4e0a\u4e0b\u6587\u65e5\u5fd7\u53d1\u5230\u4e00\u4e2a\u6587\u4ef6\u670d\u52a1\u5668\uff0c\u6709\u5229\u4e8e\u5206\u6790\u5f02\u5e38\u7684\u539f\u56e0\u3002\u4f8b\u5982\u5982\u679c\u6709\u901a\u4fe1\u6570\u636e\u65e5\u5fd7\uff0c\u53ef\u4ee5\u5148\u5224\u65ad\u662f\u540e\u7aef\u8fd4\u56de\u6570\u636e\u5f02\u5e38\uff0c\u8fd8\u662f\u524d\u7aef\u903b\u8f91\u51fa\u95ee\u9898\u3002\u56e0\u6b64\uff0c\u6211\u4f1a\u5728\u9879\u76ee\u91cc\u8bbe\u8ba1\u4e00\u4e2a\u7edf\u4e00\u7684\u65e5\u5fd7\u7cfb\u7edf\uff0c\u6e38\u620f\u91cc\u6240\u6709\u65e5\u5fd7\u7684\u6253\u5370\u90fd\u4f7f\u7528\u8be5\u65e5\u5fd7\u7cfb\u7edf\u8fdb\u884c\u6253\u5370\u3002\n\u9996\u5148\u5bf9\u65e5\u5fd7\u8fdb\u884c\u5206\u7ea7\n\/\/\u65e5\u5fd7\u7b49\u7ea7\u679a\u4e3e\nexport enum LogLv {\n    DEBUG = 0,\n    INFO,\n    WARN,\n    ERROR\n}\n\u8c03\u8bd5\u548c\u5185\u90e8\u6d4b\u8bd5\u65f6\u6253\u5f00\u6240\u6709\u7b49\u7ea7\u7684\u65e5\u5fd7\uff0c\u4e0a\u7ebf\u540e\u53ea\u6253\u5f00info\u7b49\u7ea7\u4ee5\u4e0a\u7684\u65e5\u5fd7\u3002\n\u4ea7\u54c1\u4e0a\u7ebf\u540e\uff0c\u65e5\u5fd7\u9700\u8981\u7f13\u5b58\uff0c\u5728\u5f02\u5e38\u53d1\u751f\u65f6\u8fdb\u884c\u4e0a\u62a5\nprivate static MAX_LEN: number = 5000;\nprivate static CLEAR_COUNT: number = 1000;\nprivate static logs: Array&lt;LogInfo&gt; = [];\n\u8fd9\u91cc\u8bbe\u5b9a\u4e00\u4e2a\u6e05\u7406\u7684\u6761\u6570\uff0c\u5f53\u7f13\u5b58\u8fbe\u5230\u4e0a\u9650\uff0c\u628a\u6307\u5b9a\u6761\u6570\u7684\u65e7\u65e5\u5fd7\u6e05\u7406\u51fa\u53bb\u3002\u5f53\u7136\u4e5f\u53ef\u4ee5\u4f7f\u7528\u94fe\u8868\u5b9e\u73b0\u7684\u961f\u5217\u6216\u73af\u5f62buffer\u7f13\u5b58\uff0c\u8fbe\u5230\u4e0a\u9650\u540e\u53ea\u66ff\u6362\u4e00\u6761\u3002\n\u6bcf\u6b21\u8c03\u7528\u6253\u5370\u65b9\u6cd5\u65f6\uff0c\u6839\u636e\u8bbe\u5b9a\u7684\u65e5\u5fd7\u7b49\u7ea7\u8fdb\u884c\u62e6\u622a\uff0c\u5982\u679c\u6253\u5370\u7b49\u7ea7\u5c0f\u4e8e\u8f93\u51fa\u7b49\u7ea7\uff0c\u4e0d\u505a\u8f93\u51fa\u3002\u6bcf\u4e2a\u6253\u5370\u90fd\u53ef\u4ee5\u6dfb\u52a0tag\uff0c\u65b9\u4fbf\u65e5\u5fd7\u6392\u67e5\u65f6\u6839\u636e\u6a21\u5757\u5b9a\u4f4d\u95ee\u9898\u3002\n\/\/\u6536\u96c6\u3001\u6253\u5370\u8c03\u8bd5\u7b49\u7ea7\u7684\u65e5\u5fd7\npublic static debug(tag: string, msg: string): void {\n    if (Logger.level &gt; LogLv.DEBUG) {\n        return;\n    }\n    let logMsg = \"[DEBUG] [\" + tag + \"] \" + msg;\n    Logger._addLog(LogLv.DEBUG, logMsg);\n    cc.log(logMsg);\n}\n\u65e5\u5fd7\u7f13\u5b58\u5904\u7406\n\/\/\u6dfb\u52a0\u7f13\u5b58\u65e5\u5fd7\nprivate static _addLog(level: LogLv, logMsg: string): void {\n    if (Logger.logs.length &gt;= Logger.MAX_LEN) {\n        Logger.logs.splice(0, Logger.CLEAR_COUNT);\n    }\n    Logger.logs.push({\n        level: level,\n        msg: logMsg\n    });\n}\n\u5bf9\u4e8e\u7f51\u9875\u7248\u672c\uff0c\u53ef\u4ee5\u5b9e\u73b0window.onerror\u65b9\u6cd5\uff0c\u5728\u8fd9\u91cc\u628a\u6240\u6709\u65e5\u5fd7\u8fde\u63a5\u6210\u5b57\u7b26\u4e32\u4e0a\u4f20\u5230\u65e5\u5fd7\u6587\u4ef6\u670d\u52a1\u5668\uff0c\u5b9e\u73b0\u5bf9\u5f02\u5e38\u65e5\u5fd7\u7684\u6536\u96c6\u4e0a\u62a5\u3002\n\u65e5\u5fd7\u7cfb\u7edf\u5148\u8bf4\u5230\u8fd9\u91cc\uff0c\u4e0b\u4e00\u7bc7\u6211\u4eec\u5c06\u4ecb\u7ecd\u4e0b\u600e\u6837\u505a\u6d88\u606f\u5206\u53d1\u3002","categories":"\u6559\u7a0b","tags":[""]},{"title":"\u6d88\u606f\u5206\u53d1","url":"https:\/\/naka1205.github.io\/cocos\/p\/748D14A6DC9142BB.html","content":"\u6d88\u606f\u5206\u53d1\n\u672c\u7bc7\u5f00\u59cb\u4ecb\u7ecd\u6e38\u620f\u4e1a\u52a1\u67b6\u6784\u76f8\u5173\u7684\u5185\u5bb9\u3002\u5728\u6e38\u620f\u4e1a\u52a1\u5c42\uff0c\u6240\u6709\u9700\u8981\u9694\u79bb\u7684\u7cfb\u7edf\u548c\u6a21\u5757\u95f4\u901a\u4fe1\u90fd\u53ef\u4ee5\u901a\u8fc7\u6d88\u606f\u5206\u53d1\u89e3\u8026\u3002\u4f8b\u5982\u7f51\u7edc\u8fd4\u56de\u901a\u77e5\u3001\u6570\u636e\u66f4\u65b0\u540c\u6b65\u5230\u754c\u9762\u7b49\u3002\n\u6d88\u606f\u5206\u53d1\u57fa\u4e8e\u89c2\u5bdf\u8005\u6a21\u5f0f\u8bbe\u8ba1\u3002\u9700\u8981\u5904\u7406\u6d88\u606f\u7684\u5730\u65b9\u5411\u6d88\u606f\u4e2d\u5fc3\u6ce8\u518c\u76d1\u542c\u56de\u8c03\uff0c\u6d3e\u53d1\u6d88\u606f\u65f6\uff0c\u8c03\u7528\u6d88\u606f\u4e2d\u5fc3\u7684\u6d3e\u53d1\u63a5\u53e3\u904d\u5386\u8be5\u6d88\u606f\u7684\u76d1\u542c\u961f\u5217\uff0c\u8c03\u7528\u5bf9\u5e94\u7684\u56de\u8c03\u65b9\u6cd5\u3002\n\u5148\u5b9a\u4e49\u76d1\u542c\u56de\u8c03\u7c7b\u578b\n\/\/\u6d88\u606f\u76d1\u542c\u56de\u8c03\u65b9\u6cd5\nexport type NotifyListener = (src: any, data: any) =&gt; void;\n\u901a\u8fc7key-value\u65b9\u5f0f\u4fdd\u5b58\u76d1\u542c\u961f\u5217\nprivate static msg2listDict: Dictionary&lt; string, Array&lt;NotifyListenerInfo&gt; &gt; = new Dictionary&lt; string, Array&lt;NotifyListenerInfo&gt; &gt;();\n\u63a5\u53e3\u5b9a\u4e49\n\/\/\u6dfb\u52a0\u591a\u6b21\u76d1\u542c\u8005\uff0c\u9700\u8981\u624b\u52a8\u79fb\u9664\npublic static addListener(msg: string, listener: NotifyListener, target?: any): void {}\n\/\/\u6dfb\u52a0\u5355\u6b21\u76d1\u542c\u8005\uff0c\u4e8b\u4ef6\u89e6\u53d1\u540e\u5373\u79fb\u9664\npublic static addOnceListener(msg: string, listener: NotifyListener, target?: any): void {}\n\/\/\u79fb\u9664\u6307\u5b9a\u6d88\u606f\u6307\u5b9a\u7684\u76d1\u542c\u8005\npublic static removeMsgListener(msg: string, listener: NotifyListener): void {}\n\/\/\u79fb\u9664\u6307\u5b9a\u6d88\u606f\u6240\u6709\u76d1\u542c\u8005\npublic static removeMsgAllListeners(msg: string): void {}\n\/\/\u79fb\u9664\u6307\u5b9a\u76ee\u6807\u5bf9\u6307\u5b9a\u6d88\u606f\u7684\u76d1\u542c\npublic static removeTargetMsgListen(msg: string, target: any): void {}\n\/\/\u79fb\u9664\u6307\u5b9a\u76ee\u6807\u6240\u6709\u6d88\u606f\u76d1\u542c\npublic static removeTargetAllMsgListen(target: any): void {}\n\/\/\u6d3e\u53d1\u6d88\u606f\npublic static notify(msg: string, src: any, data: any): void {}\n\u5728\u6dfb\u52a0\u79fb\u9664\u5b9e\u73b0\u4e2d\uff0c\u9700\u8981\u6ce8\u610f\u67d0\u6d88\u606f\u53ef\u80fd\u6b63\u5728\u6d3e\u53d1\u3002\n\u5bf9\u4e8e\u4e00\u4e2a\u6d88\u606f\u65b0\u6dfb\u52a0\u7684\u76d1\u542c\u8005\uff0c\u5e94\u8be5\u5728\u5f53\u524d\u961f\u5217\u6d88\u606f\u6d3e\u53d1\u5b8c\u540e\u518d\u6d3e\u53d1\uff0c\u56e0\u6b64\uff0c\u6dfb\u52a0\u4e00\u4e2a\u5f85\u6dfb\u52a0\u961f\u5217\nprivate static listener2add: Array&lt;NotifyListenerInfo&gt; = [];\n\u5728\u6dfb\u52a0\u76d1\u542c\u8005\u65f6\u505a\u4ee5\u4e0b\u5224\u65ad\n\/\/ \u8be5\u6d88\u606f\u6b63\u5728\u6d3e\u53d1\uff0c\u653e\u5165\u5f85\u6dfb\u52a0\u961f\u5217\nif (NotifyCenter.notifyMsgs.indexOf(msg) &gt;= 0) {\n    NotifyCenter.listener2add.push(info);\n    return;\n}\n\u540c\u6837\u5728\u79fb\u9664\u76d1\u542c\u8005\u65f6\uff0c\u53ef\u80fd\u6b63\u5728\u6d3e\u53d1\u6d88\u606f\uff0c\u907f\u514d\u5bf9\u961f\u5217\u7684\u4fee\u6539\u5bfc\u81f4for\u5faa\u73af\u5f02\u5e38\uff0c\u6dfb\u52a0\u4e00\u4e2a\u5f85\u79fb\u9664\u961f\u5217\uff0c\u6d3e\u53d1\u6d88\u606f\u65f6\uff0c\u5982\u679c\u8be5\u76d1\u542c\u8005\u5728\u79fb\u9664\u961f\u5217\u5219\u4e0d\u6d3e\u53d1\u3002\u5728\u6d88\u606f\u6d3e\u53d1\u5b8c\u540e\u518d\u5c06\u5176\u79fb\u51fa\u961f\u5217\nprivate static listener2remove: Array&lt;NotifyListenerInfo&gt; = [];\n\u5728\u79fb\u9664\u76d1\u542c\u8005\u65f6\u505a\u4ee5\u4e0b\u5224\u65ad\n\/\/ \u8be5\u6d88\u606f\u6b63\u5728\u6d3e\u53d1\uff0c\u653e\u5165\u5f85\u79fb\u9664\u961f\u5217\nif (NotifyCenter.notifyMsgs.indexOf(msg) &gt;= 0) {\n    NotifyCenter.listener2remove.push(list[i]);\n} else {\n    list.splice(i, 1);\n}\n\u6d3e\u53d1\u6d88\u606f\u65f6\u904d\u5386\u6307\u5b9a\u6d88\u606f\u4e0b\u7684\u961f\u5217\n\/\/ \u961f\u5217\u4e0d\u5b58\u5728\uff0c\u4e0d\u9700\u8981\u5904\u7406\nlet list = NotifyCenter.msg2listDict.get(msg);\nif (!list) {\n    return;\n}\n\/\/ \u6807\u8bb0\u6d88\u606f\u6b63\u5728\u6d3e\u53d1\uff0c\u591a\u4e2a\u6d88\u606f\u53ef\u80fd\u540c\u65f6\u5728\u6d3e\u53d1\uff0c\u540c\u4e00\u6d88\u606f\u53ef\u80fd\u6807\u8bb0\u591a\u6b21\nNotifyCenter.notifyMsgs.push(msg);\n\/\/ \u5904\u7406\u6d88\u606f\u6d3e\u53d1\nfor (let i = 0, n = list.length; i &lt; n; i++) {\n    NotifyCenter._dispatch(list[i], src, data, false);\n}\n\u6d3e\u53d1\u6d88\u606f\u65f6\u5148\u5224\u65ad\u662f\u5426\u5728\u79fb\u9664\u961f\u5217\n\/\/ \u5728\u79fb\u9664\u961f\u5217\uff0c\u4e0d\u6d3e\u53d1\nif (NotifyCenter.listener2remove.indexOf(info) &gt;= 0) {\n    return;\n}\n\u5f53\u524d\u961f\u5217\u6d3e\u53d1\u5b8c\u540e\u68c0\u67e5\u5f85\u6dfb\u52a0\u961f\u5217\n\/\/ \u5904\u7406\u5f85\u6dfb\u52a0\u961f\u5217\u6d3e\u53d1\nfor (let i = 0, n = msg2add.length; i &lt; n; i++) {\n    if (listener2add[i].msg == msg) {\n        NotifyCenter._dispatch(listener2add[i], src, data, true);\n    }\n}\n\u5f15\u5165\u6d88\u606f\u5206\u53d1\u4e2d\u5fc3\uff0c\u9694\u79bb\u7684\u7cfb\u7edf\u3001\u6a21\u5757\u95f4\u901a\u8fc7\u6d88\u606f\u76d1\u542c\u548c\u6d3e\u53d1\u901a\u4fe1\uff0c\u907f\u514d\u4e92\u76f8\u5f15\u7528\u8026\u5408\u3002\n\u6d88\u606f\u5206\u53d1\u5148\u8bf4\u5230\u8fd9\u91cc\uff0c\u4e0b\u4e00\u7bc7\u6211\u4eec\u5c06\u4ecb\u7ecd\u6e38\u620f\u4e1a\u52a1\u5c42\u67b6\u6784\u3002","categories":"\u6559\u7a0b","tags":[""]},{"title":"MVC\u67b6\u6784","url":"https:\/\/naka1205.github.io\/cocos\/p\/DE657CA8EE77BE83.html","content":"MVC\u67b6\u6784\n\u8fd9\u4e00\u7bc7\u5c06\u4ecb\u7ecd\u5728\u6e38\u620f\u5ba2\u6237\u7aef\u5e38\u7528\u7684\u67b6\u6784MVC\u67b6\u6784\u3002\u4e00\u4e2a\u6e38\u620f\u7684MVC\u5982\u4e0b\u5212\u5206\uff1a\n\nM\uff1a1\uff09\u5355\u4f8b\u5168\u5c40\u7684\u6570\u636e\u4e2d\u5fc3World\uff0c\u6240\u6709\u6e38\u620f\u6a21\u5757\u7684\u6570\u636e\u5728World\u4e2d\u6709\u5165\u53e3\uff0c2\uff09\u5404\u4e2a\u6a21\u5757\u81ea\u5df1\u7684\u6570\u636e\u7ed3\u6784\u3002\nV\uff1a1\uff09\u901a\u8fc7creator\u9884\u5236\u4f53\u5236\u4f5c\u7684UI\u754c\u9762\u3001\u573a\u666f\uff0c2\uff09\u5404\u4e2a\u754c\u9762\u663e\u793a\u903b\u8f91\u7684ViewCtrl\nC\uff1a1\uff09\u5168\u5c40\u7684MainCtrl\uff0c2\uff09\u5404\u4e2a\u6a21\u5757\u7684\u4e1a\u52a1\u903b\u8f91\u7c7bModuleCtrl\n\n\u5148\u4ecb\u7ecdM\u90e8\u5206\u3002\u7531\u4e8e\u4e00\u4e2a\u6a21\u5757\u7684\u6570\u636e\uff0c\u5728\u5176\u4ed6\u6a21\u5757\u4e5f\u6709\u8bbf\u95ee\u7684\u9700\u6c42\uff0c\u4f8b\u5982\u597d\u53cb\u6a21\u5757\uff0c\u5728\u804a\u5929\u7684\u65f6\u5019\u4e5f\u9700\u8981\u8bbf\u95ee\uff0c\u5728\u6392\u884c\u699c\u91cc\u9700\u8981\u8bbf\u95ee\u3002\u6570\u636e\u5e94\u8be5\u6709\u4e00\u4e2a\u5355\u4f8b\u5168\u5c40\u7684\u6570\u636e\u4e2d\u5fc3\u7c7bWorld\uff0c\u6240\u6709\u6e38\u620f\u6a21\u5757\u7684\u6570\u636e\u7c7b\u5728World\u4e2d\u6709\u5165\u53e3\u3002\u8fd9\u4e9b\u6570\u636e\u53ef\u4ee5\u5728\u73a9\u5bb6\u767b\u5f55\u540e\u4ece\u670d\u52a1\u5668\u83b7\u53d6\u5e76\u8bbe\u7f6e\u3002\nexport class World {\n    private static instance: World = null;\n    private _test: TestData = null;\n    \/\/\u5355\u4f8b\u6a21\u5f0f\n    private constructor() {\n\n    }\n    \/\/\u83b7\u53d6\u5b9e\u4f8b\n    public static get inst(): World {\n        if (!World.instance) {\n            World.instance = new World();\n        }\n        return World.instance;\n    }\n\n    \/\/ FOR TEST\n    public set test(val: TestData) {\n        this._test = val;\n    }\n\n    public get test(): TestData {\n        return this._test;\n    }\n}\n\u8fd9\u6837\u6a21\u5757\u95f4\u53ef\u4ee5\u72ec\u7acb\u8bbe\u8ba1\u81ea\u5df1\u7684\u6570\u636e\u7ed3\u6784\uff0c\u901a\u8fc7\u53d1\u9001\u6d88\u606f\u8bf7\u6c42\u5bf9\u5e94\u6a21\u5757\u7684ModuleCtrl\u66f4\u6539\uff0c\u901a\u8fc7World\u8bfb\u53d6\u3002\n\nexport class TestData {\n    private _text: string = null;\n\n    public constructor() {\n\n    }\n\n    public set text(val: string) {\n        this._text = val;\n    }\n\n    public get text(): string {\n        return this._text;\n    }\n}\n\u4e0a\u4e00\u7ae0\u4ecb\u7ecd\u8fc7\u6d88\u606f\u5206\u53d1\u3002\u6570\u636e\u7684\u66f4\u65b0\u65f6\u53ef\u4ee5\u6d3e\u53d1\u6d88\u606f\uff0c\u754c\u9762\u53ef\u4ee5\u76d1\u542c\u6d88\u606f\u505a\u5237\u65b0\u3002\n\u4e0b\u9762\u4ecb\u7ecd\u754c\u9762\u548c\u811a\u672c\u4ee3\u7801\u7684\u5173\u8054\u3002\u524d\u9762\u7bc7\u7ae0\u4e2d\u4ecb\u7ecd\u8fc7\uff0ccocos creator\u662f\u57fa\u4e8e\u7ec4\u4ef6\u6a21\u5f0f\u3002\u6211\u5c06\u6bcf\u4e2aui\u754c\u9762\u90fd\u505a\u6210\u4e00\u4e2a\u9884\u5236\u4f53\uff0c\u6bcf\u4e2a\u9884\u5236\u4f53\u90fd\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e2a\u811a\u672c\u7ec4\u4ef6\uff0c\u7528\u4e8e\u63a7\u5236\u8fd9\u4e2a\u754c\u9762\u7684\u663e\u793a\u903b\u8f91\u3002\n\n\n\u5728\u5f39\u7a97\u7ba1\u7406\u91cc\u63d0\u5230\u6211\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u7ee7\u627fcc.Component\u7684\u7c7b\u53ebViewCtrl\uff0c\u6240\u6709\u754c\u9762\u7684\u663e\u793a\u903b\u8f91\u7c7b\u90fd\u7ee7\u627fViewCtrl\uff0c\u5e76\u6dfb\u52a0\u5230\u5bf9\u5e94\u7684\u754c\u9762\u9884\u5236\u4f53\u3002\u524d\u9762\u63d0\u5230\u6570\u636e\u66f4\u65b0\u65f6\u4f1a\u6d3e\u53d1\u6d88\u606f\uff0cViewCtrl\u76d1\u542c\u6570\u636e\u66f4\u65b0\u6d88\u606f\uff0c\u5237\u65b0\u5173\u8054\u7684\u754c\u9762\u3002\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class TestViewCtrl extends ViewCtrl {\n}\nViewCtrl\u53ea\u5904\u7406\u754c\u9762\u7684\u663e\u793a\u903b\u8f91\uff0c\u4e0d\u5904\u7406\u6570\u636e\u4e1a\u52a1\u903b\u8f91\uff0c\u6a21\u5757\u7684\u6570\u636e\u4e1a\u52a1\u903b\u8f91\u7531\u8be5\u6a21\u5757\u7684ModuleCtrl\u5904\u7406\u3002ViewCtrl\u54cd\u5e94\u7528\u6237\u64cd\u4f5c\uff0c\u6d3e\u53d1\u6d88\u606f\uff0cModuleCtrl\u76d1\u542c\u6d88\u606f\u5904\u7406\u3002\u5927\u90e8\u5206\u6a21\u5757\u7684ModuleCtrl\u4e3b\u8981\u505a\u7f51\u7edc\u901a\u4fe1\uff0c\u548c\u5bf9\u672c\u6a21\u5757\u7f13\u5b58\u6570\u636e\u7684\u4fee\u6539\u3002\nexport class TestCtrl {\n\n    public constructor() {\n\n    }\n\n    public init(): void {}\n\n    public start(): void {\n        NotifyCenter.addListener(MSG_TEST_HTTP, (src: any, data: any) =&gt; {\n            this.testHttp();\n        }, this);\n    }\n\n    public testHttp(): void {\n        let data = {\n            mod: 1, \/\/ \u6a21\u5757\n            cmd: 1, \/\/ \u547d\u4ee4\n        }\n        let params: HttpReq = {\n            path: \"\",\n            method: HTTP_METHOD_GET\n        }\n        MainCtrl.inst.http.sendData(data, params, (data: NetData) =&gt; {\n            World.inst.test = new TestData();\n            World.inst.test.text = \"123\";\n        }, (code: number, reason: string) =&gt; {});\n    }\n}\n\u524d\u9762\u63d0\u5230\uff0cC\u5c42\u8fd8\u6709\u4e00\u4e2a\u5168\u5c40\u5355\u4f8b\u7684MainCtrl\u3002\u8be5\u7c7b\u4e3b\u8981\u8d1f\u8d23\u6a21\u5757\u6ce8\u518c\u3001\u63d0\u4f9b\u5168\u5c40\u7684\u64cd\u4f5c\u63a5\u53e3\uff08\u4f8b\u5982\u754c\u9762\/\u573a\u666f\u7684\u663e\u9690\uff09\u3001\u7f51\u7edc\u901a\u4fe1\u5904\u7406\u3002\nMVC\u67b6\u6784\u5148\u8bf4\u5230\u8fd9\u91cc\uff0c\u4e0b\u4e00\u7bc7\u6211\u4eec\u5c06\u4ecb\u7ecd\u4ee3\u7801\u7ec4\u7ec7\u3002","categories":"\u6559\u7a0b","tags":[""]},{"title":"\u4ee3\u7801\u7ed3\u6784","url":"https:\/\/naka1205.github.io\/cocos\/p\/E593CAA756CFDE55.html","content":"\u4ee3\u7801\u7ed3\u6784\n\u8fd9\u4e00\u7bc7\u7b80\u5355\u4ecb\u7ecd\u4e0b\u4ee3\u7801\u7ed3\u6784\uff0c\u6e05\u6670\u7684\u4ee3\u7801\u7ed3\u6784\u66f4\u6709\u5229\u4e8e\u56e2\u961f\u5bf9\u9879\u76ee\u7684\u7406\u89e3\u548c\u7ef4\u62a4\u3002\n\n\u524d\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86\u4e00\u7cfb\u5217\u57fa\u7840\u529f\u80fd\u5c01\u88c5\uff0c\u8fd9\u90e8\u5206\u5185\u5bb9\u53ef\u4ee5\u88ab\u4e0d\u540c\u7684\u6e38\u620f\u91cd\u7528\u3002\u8fd9\u4e00\u90e8\u5206\u4ee3\u7801\u90fd\u53ef\u4ee5\u653e\u5230framework\u76ee\u5f55\u4e0b\u3002\n\u6e38\u620f\u4e1a\u52a1\u4ee3\u7801\u7edf\u4e00\u653e\u5230game\u76ee\u5f55\u4e0b\n\u5e73\u53f0sdk\u63a5\u5165\u4ee3\u7801\u653e\u5230channel\u76ee\u5f55\u4e0b\n\u6570\u636e\u4e0a\u62a5\u7684sdk\u63a5\u5165\u4ee3\u7801\u653e\u5230report\u76ee\u5f55\u4e0b\u3002\n\n\nStartCtrl\u662f\u9879\u76ee\u7684\u5165\u53e3\uff0c\u8d1f\u8d23\u9879\u76ee\u7684\u521d\u59cb\u5316\uff0c\u5305\u62ec\u6e20\u9053sdk\u3001\u6570\u636e\u4e0a\u62a5sdk\u8bbe\u5b9a\u3001\u6e38\u620f\u521d\u59cb\u5316\u3002\nframework\u76ee\u5f55\u4e0b\u9762\u90fd\u662f\u4e00\u4e9b\u57fa\u7840\u529f\u80fd\u3002\n\ngame\u76ee\u5f55\u4e0b\u6309\u7167\u6a21\u5757\u5212\u5206\u76ee\u5f55\n\n\u6bcf\u4e00\u4e2a\u6e38\u620f\u4e1a\u52a1\u6a21\u5757\u4e0b\u6839\u636emvc\u5212\u5206\u76ee\u5f55\n\n\u4ee3\u7801\u7ec4\u7ec7\u5148\u8bf4\u5230\u8fd9\u91cc\uff0c\u4e0b\u4e00\u7bc7\u6211\u4eec\u5c06\u4ecb\u7ecd\u74e6\u7247\u5730\u56fe\u3002","categories":"\u6559\u7a0b","tags":[""]},{"title":"\u74e6\u7247\u5730\u56fe","url":"https:\/\/naka1205.github.io\/cocos\/p\/22AC2C263EC626A0.html","content":"\u74e6\u7247\u5730\u56fe\n\u8fd9\u4e00\u7bc7\u4ecb\u7ecd\u74e6\u7247\u5730\u56fe\uff0c\u5728\u5f00\u53d1\u6a21\u62df\u7ecf\u8425\u7c7b\u6e38\u620f\u3001SLG\u7c7b\u6e38\u620f\u3001RPG\u6e38\u620f\uff0c\u90fd\u4f1a\u4f7f\u7528\u5230\u74e6\u7247\u5730\u56fe\u3002\u74e6\u7247\u5730\u56fe\u5730\u9762\u662f\u901a\u8fc7\u4e00\u4e2a\u4e2a\u5730\u7816\u62fc\u8d77\u6765\u7684\uff0c\u53c8\u5206\u4e3a45\u5ea6\u89d2\u548c90\u5ea6\u89d2\u4e24\u79cd\u300245\u5ea6\u89d2\u4fd7\u79f02.5D\uff0c\u6bcf\u4e2a\u683c\u5b50\u90fd\u662f\u83f1\u5f62\uff0c\u800c90\u5ea6\u89d2\u6bcf\u4e2a\u683c\u5b50\u90fd\u662f\u6b63\u65b9\u5f62\u3002\n\u74e6\u7247\u5730\u56fe\u4e00\u822c\u5305\u62ec\u4ee5\u4e0b\u56fe\u5c42\uff08\u4e0d\u4e00\u5b9a\u540c\u65f6\u5b58\u5728\uff0c\u4f8b\u5982\u4e00\u822cRPG\u6e38\u620f\u6ca1\u6709\u80cc\u666f\u548c\u81ea\u7531\u88c5\u9970\u5c42\uff09\uff1a\n\n\u80cc\u666f\u5c42\uff08\u5927\u56fe\u62fc\u63a5\u7684\u80cc\u666f\uff09\n\u5730\u5f62\u5c42\uff08\u74e6\u7247\u683c\u5b50\u62fc\u63a5\u7684\u5730\u5f62\uff09\n\u5efa\u7b51\u5c42\uff08\u6309\u74e6\u7247\u683c\u5b50\u6446\u653e\u7684\u5efa\u7b51\u3001\u5730\u9762\u7269\u54c1\u3001\u89d2\u8272\uff09\n\u81ea\u7531\u88c5\u9970\u5c42\uff08\u4e91\u6735\u3001\u70df\u96fe\uff09\n\u9664\u6b64\u4ee5\u5916\uff0c\u8fd8\u9700\u8981\u63d0\u4f9b\u9690\u85cf\u7684\u5c42\u7528\u4e8e\u7f16\u8f91\u6570\u636e\uff0c\u63a7\u5236\u6e38\u620f\u903b\u8f91\uff0c\u4f8b\u5982\u963b\u6321\u3001\u6446\u653e\u533a\u57df\u7b49\uff0c\u79f0\u4e3a\u6570\u636e\u5c42\u3002\u5176\u4e2d\u9700\u8981\u74e6\u7247\u5e03\u5c40\u7684\u67093\u79cd\u56fe\u5c42\uff1a\u5730\u5f62\u5c42\u3001\u5efa\u7b51\u5c42\u3001\u6570\u636e\u5c42\u3002\n\n\u5148\u6765\u8bf4\u8bf4\u80cc\u666f\u5c42BgLayer\uff0c\u80cc\u666f\u5c42\u5728\u7f8e\u672f\u8bbe\u8ba1\u91cc\u662f\u5f20\u5b8c\u6574\u7684\u5927\u56fe\uff0c\u4e3a\u4e86\u907f\u514d\u8fde\u7eed\u5185\u5b58\u592a\u5927\u5bfc\u81f4\u52a0\u8f7d\u5931\u8d25\uff0c\u628a\u5927\u56fe\u6253\u788e\u6210\u7b49\u5927\u5c0f\u7684\u5c0f\u56fe\u62fc\u63a5\u3002\u4e00\u822c\u51fa\u4e8e\u6027\u80fd\u8003\u8651\uff0c\u5c0f\u56fe\u957f\u5bbd\u9009\u62e9\u4e3a1024\u3001512\u3001256\u3001128\u3002\n\u8bbe\u7f6e\u80cc\u666f\u9700\u8981\u63d0\u4f9b\u80cc\u666f\u7684\u5c0f\u56fe\u6570\u7ec4\uff0c\u5217\u6570\uff0c\u6bcf\u5f20\u5c0f\u56fe\u7684\u5bbd\u9ad8\npublic setPieces(fileArr: Array&lt;string&gt;, colCount: number, pieceW: number, pieceH: number, loadAtOnce: boolean = true): void {}\n\u5982\u679c\u662f\u5728H5\u5e73\u53f0\uff0c\u8981\u8003\u8651\u8d44\u6e90\u7684\u9010\u6b65\u52a0\u8f7d\u3002\u6240\u4ee5\u5728H5\u5e73\u53f0\u8be5\u65b9\u6cd5\u6700\u597d\u53ea\u662f\u505a\u5360\u4f4d\uff0c\u63d0\u4f9b\u65b9\u6cd5\u8fdb\u884c\u8d44\u6e90\u52a0\u8f7d\npublic loadPiece(file: string) {}\n\u9664\u4e86\u52a0\u8f7d\u5916\uff0c\u7531\u4e8e\u73a9\u5bb6\u5728\u79fb\u52a8\u5730\u56fe\u65f6\u53ea\u770b\u5230\u80cc\u666f\u7684\u4e00\u90e8\u5206\uff0c\u4e0d\u5728\u89c6\u7a97\u5185\u7684\u5e94\u8be5\u88c1\u526a\u6389\uff0c\u6240\u4ee5\u8fd8\u8981\u63d0\u4f9b\u65b9\u6cd5\u5bf9\u80cc\u666f\u8fdb\u884c\u88c1\u526a\npublic setViewPort(x: number, y: number, w: number, h: number): void {}\n\u5b8c\u5168\u4e0d\u5728\u89c6\u7a97\u7684\u5c0f\u56fe\uff0c\u901a\u8fc7removeFromParent\u4ece\u6e32\u67d3\u5217\u8868\u79fb\u9664\u3002\n\u63a5\u4e0b\u6765\u8bf4\u8bf4\u57fa\u4e8e\u74e6\u7247\u5e03\u5c40\u7684\u56fe\u5c42\u3002\u57fa\u4e8e\u74e6\u7247\u7684\u56fe\u7247\u6211\u4eec\u4f1a\u6446\u653e\u4e00\u4e9b\u7269\u54c1\uff0c\u4f8b\u5982\u5730\u5f62\u5c42\u7684\u5730\u5f62\u5757\u3001\u5efa\u7b51\u5c42\u7684\u5efa\u7b51\u3001\u5730\u9762\u7269\u54c1\u3001\u89d2\u8272\u3002\u6240\u4ee5\u5728\u4ecb\u7ecd\u74e6\u7247\u5e03\u5c40\u7684\u56fe\u5c42\u524d\uff0c\u5148\u4ecb\u7ecd\u4e0b\u5730\u56fe\u91cc\u7684\u7269\u54c1\u3002\u4e00\u822c\u5305\u62ec\uff1a\n\n\u5730\u5f62\u5757\n\u5efa\u7b51\u3001\u5730\u9762\u7269\u54c1\n\u89d2\u8272\n\u7f16\u8f91\u6570\u636e\n\n\u5148\u8bbe\u8ba1\u4e00\u4e2a\u57fa\u7c7bMapItem\uff0c\u5b9a\u4e49\u7269\u54c1\u7684\u57fa\u672c\u5c5e\u6027\uff1a\u683c\u5b50\u4f4d\u7f6e\u3001\u5bbd\u9ad8\u5360\u683c\u5b50\u6570\u3001\u662f\u5426\u53ef\u7a7f\u8d8a\u3001\u53ef\u5426\u7f16\u8f91\nexport class MapItem extends cc.Component {\n    protected mGridX: number = 0;\n    protected mGridY: number = 0;\n    protected mRow: number = 1;\n    protected mCol: number = 1;\n    protected mCanPass: boolean = true;\n    private mEditable: boolean = true;\n    private mIsLock: boolean = false;\n}\n\u5730\u5f62\u5757\u4e3b\u8981\u662f\u663e\u793a\u4e00\u5f20\u4e00\u683c\u5927\u5c0f\u7684\u56fe\u7247\uff0c\u4e00\u822c\u4f1a\u5148\u628a\u8fd9\u4e9b\u5730\u5f62\u56fe\u7247\u5408\u6210\u4e00\u5f20\u5927\u56fe\uff0c\u6309\u7167\u683c\u5b50\u5927\u5c0f\u7b49\u5206\u3002\u8bbe\u8ba1\u4e00\u4e2aTileSet\u7c7b\u5b9a\u4e49\u8fd9\u5f20\u5408\u56fe\u7684\u7ed3\u6784\nexport class TileSet {\n    private mId: number = -1;\n    private resPath: string = null;\n    private tex: cc.Texture2D = null;\n    private gridW: number = 0;\n    private gridH: number = 0;\n    private row: number = 0;\n    private col: number = 0;\n}\n\u6bcf\u4e2a\u5730\u5f62\u5757Tile\u5f15\u7528TileSet\u91cc\u7684\u8d44\u6e90\nexport class Tile extends MapItem {\n    private mSpr: cc.Sprite = null;\n    private mId: number = 0;\n    private mTileSetId: number = 0;\n    private mIdx: number = 0;\n}\n\u5f53\u7136\uff0c\u5982\u679c\u5e0c\u671b\u5730\u9762\u6709\u5e27\u52a8\u753b\uff0c\u4e5f\u53ef\u4ee5\u8ba9Tile\u4fdd\u5b58\u4e00\u4e2a\u5e27\u7cfb\u5217\uff0c\u6309\u987a\u5e8f\u5207\u6362mSpr\u7684spriteFrame\u5c5e\u6027\u3002\n\u5efa\u7b51\u8981\u8003\u8651\u5efa\u7b51\u3001\u5730\u9762\u7269\u54c1\u7684\u65b9\u5411\u548c\u64cd\u4f5c\nexport class MapBuilding extends MapItem {\n    protected mId: number = 0;\n    protected mType: number = 0;\n    protected mResType: number = 0; \/\/ 0 image, 1 spine\n    protected mResPath: string = null;\n    protected mDir: number = 0;\n    protected mReverse: boolean = false;\n}\n\u4e3a\u4e86\u533a\u5206\u6446\u653e\u548c\u65cb\u8f6c\u70b9\uff0c\u6211\u4f1a\u7ed9MapBuilding\u6dfb\u52a0\u4e24\u4e2a\u5b50\u8282\u70b9\uff0c\u56e0\u4e3a\u572845\u89d2\u5730\u56fe\u6446\u653e\u5efa\u7b51\u65f6\uff0c\u4e00\u822c\u4ee5\u53f3\u4e0b\u89d2\u683c\u5b50\u505a\u6446\u653e\u53c2\u8003\u70b9\uff0c\u4f46\u662f\u65cb\u8f6c\u662f\u4ee5\u5de6\u4e0a\u89d2\u683c\u5b50\u4e3a\u53c2\u8003\u3002\n\u9700\u8981\u6ce8\u610f\uff0c\u5728H5\u5e73\u53f0\uff0c\u5efa\u7b51\u7684\u56fe\u7247\u8d44\u6e90\u5e94\u8be5\u662f\u52a8\u6001\u52a0\u8f7d\u7684\uff0c\u5728\u5730\u56fe\u79fb\u52a8\u65f6\u9010\u6e10\u52a0\u8f7d\u663e\u793a\u3002\u6240\u4ee5\u8981\u63d0\u4f9b\u63a5\u53e3\u5bf9\u8d44\u6e90\u8fdb\u884c\u52a0\u8f7d\u3002\npublic loadRes(): void {}\n\u8fd8\u6709\u70b9\u51fb\u8303\u56f4\uff0c\u56fe\u7247\u662f\u77e9\u5f62\u7684\uff0c\u70b9\u51fb\u7684\u65f6\u5019\u53ef\u80fd\u662f\u70b9\u5230\u4e86\u56fe\u7247\u7684\u7a7a\u767d\u533a\u57df\uff0c\u8fd9\u65f6\u540e\u73a9\u5bb6\u770b\u5230\u7684\u662f\u70b9\u51fb\u4e86\u540e\u9762\u7684\u5efa\u7b51\uff0c\u5982\u679c\u6ca1\u6709\u5904\u7406\u900f\u660e\u533a\u57df\u5254\u9664\uff0c\u5b9e\u9645\u5224\u65ad\u5374\u662f\u70b9\u51fb\u4e86\u524d\u9762\u7684\u5efa\u7b51\u3002\u5bf9\u4e8e\u56fe\u7247\u8d44\u6e90\u7684\u5efa\u7b51\u5728H5\u5e73\u53f0\uff0c\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u8be5\u56fe\u7247\u76f8\u540c\u4f4d\u7f6e\uff0c\u622a\u53d6\u70b9\u51fb\u533a\u7684\u4e00\u4e2a\u50cf\u7d20\uff0c\u6a21\u62df\u753b\u5728\u5c4f\u5e55\u8be5\u5730\u65b9\uff0c\u5982\u679cgetImageData\u83b7\u53d6\u7684data[3]\u4e0d\u662f0\uff0c\u8bf4\u660e\u70b9\u51fb\u5230\u4e86\u8be5\u5efa\u7b51\uff0c\u5426\u5219\u662f\u70b9\u51fb\u4e86\u7a7a\u767d\u533a\u3002\n\u89d2\u8272\u90fd\u662fspine\u52a8\u753b\uff0c\u662f\u53ef\u4ee5\u8fd0\u52a8\u7684\u7269\u4f53\uff0c\u9700\u8981\u8def\u5f84\u3001\u901f\u5ea6\u76f8\u5173\u7684\u5c5e\u6027\nexport class MapActor extends cc.Component {\n    protected mActorId: number = 0;\n    protected mResPath: string = null;\n    protected mRoadGrids: Array&lt;cc.Vec2&gt; = []; \/\/ \u8def\u5f84\n    protected mCurRoadIdx: number = 0;\n    protected mSpeed: number = 0; \/\/ \u8bbe\u7f6e\u7684\u884c\u8d70\u901f\u5ea6, \u8ddfx\u65b9\u5411\u901f\u5ea6\u7edd\u5bf9\u503c\u4e00\u6837\n    protected mSpeedX: number = 0; \/\/ \u5b9e\u65f6\u884c\u8d70X\u901f\u5ea6\n    protected mSpeedY: number = 0; \/\/ \u5b9e\u65f6\u884c\u8d70Y\u901f\u5ea6\n    protected mTestActor: boolean = false;\n    protected mIsKeepRoad: boolean = false;\n    protected mIsPauseWalk: boolean = false;\n}\n\u7f16\u8f91\u6570\u636e\u662f\u4e0d\u53ef\u89c1\u7684\uff0c\u53ea\u6709\u57fa\u672c\u7684\u4f4d\u7f6e\u4fe1\u606f\u548c\u76f8\u5e94\u6570\u636e\nexport class MapDataItem extends MapItem {\n    private data: any = null;\n}\n\u74e6\u7247\u5e03\u5c40\u7684\u56fe\u5c42\u6709\u4e00\u4e2a\u57fa\u7c7b\uff0c\u8d1f\u8d23\u7269\u54c1MapItem\u7684\u6dfb\u52a0\u3001\u5220\u9664\u3001\u67e5\u8be2\u7b49\u64cd\u4f5c\n\/\/\u57fa\u4e8e\u5730\u7816\u7684\u56fe\u5c42\u57fa\u7c7b\n\/\/\u5b9a\u4e49\u57fa\u4e8e\u5730\u7816\u56fe\u5c42\u57fa\u672c\u6570\u636e\u548c\u63a5\u53e3\nexport abstract class TileBaseLayer extends cc.Component implements GestureListener {\n    protected mRow: number = 0;\n    protected mCol: number = 0;\n    protected mGridW: number = 0;\n    protected mGridH: number = 0;\n    protected mMapItems: Array&lt;MapItem&gt; = [];\n\n    protected mOriX: number = 0;\n    protected mOriY: number = 0;\n}\n\u5bf9\u4e8e90\u5ea6\u89d2\u7684\u5730\u56fe\uff0c\u6ca1\u6709\u592a\u591a\u590d\u6742\u7684\u5730\u65b9\u9700\u8981\u5904\u7406\u3002\u70b9\u51fb\u70b9\u5230\u683c\u5b50\u7684\u6620\u5c04\u662f\u7b80\u5355\u9664\u4ee5\u5bbd\u3001\u9ad8\u3002\u906e\u6321\u662f\u4ece\u5de6\u5f80\u53f3\uff0c\u4ece\u4e0a\u5230\u4e0b\u8bbe\u5b9azorder\u3002\n\u5bf9\u4e8e45\u5ea6\u89d2\u7684\u5730\u56fe\uff0c\u70b9\u51fb\u70b9\u5230\u683c\u5b50\u7684\u6620\u5c04\u9700\u8981\u7528\u5230\u89e3\u6790\u51e0\u4f55\n\n\n\u6bcf\u4e2a\u70b9\u51fb\u70b9\uff0c\u6309\u7167\u683c\u5b50\u5bbd\u9ad8\u6bd4\u7684\u659c\u7387\u7ecf\u8fc7\u8be5\u70b9\u4f5c\u76f4\u7ebf\uff0c\u5230\u7ecf\u8fc7\u70b9\uff08oriX\uff0coriY\uff09\u5e73\u884c\u4e8ex\u8f74\u7684\u76f4\u7ebf\u90fd\u6709\u4ea4\u70b9\uff0c\u800c\u4e14\u4ea4\u70b9\u7684\u8ddd\u79bb\u7b49\u4e8e\u683c\u5b50\u7684\u5bbd\u5ea6\u3002\u6240\u4ee5\uff0c\u4ea4\u70b9\u76f8\u5bf9\u4e8e\u70b9\uff08oriX\uff0coriY\uff09\u7684\u8ddd\u79bb\uff08x - oriX\uff09\u53ef\u4ee5\u5224\u65ad\u8be5\u70b9\u5c5e\u4e8e\u54ea\u884c\u6216\u54ea\u5217\u3002\u5bf9\u4e8e\u884c\uff0c\u4ea4\u70b9\u53ef\u4ee5\u901a\u8fc7\uff08oriY - touchY\uff09 \uff08gridW \/ gridH\uff09 - \uff08touchX - oriX\uff09\u3002\u5bf9\u4e8e\u5217\uff0c\u4ea4\u70b9\u53ef\u4ee5\u901a\u8fc7\uff08touchX -  oriX\uff09 + \uff08oriY - touchY\uff09 \uff08gridW \/ gridH\uff09\u3002\uff08\u5e73\u884c\u3001\u4e09\u89d2\u5f62\u4e2d\u540c\u6837\u5927\u5c0f\u7684\u89d2\u7684\u5bf9\u8fb9\u6bd4\u90bb\u8fb9\u6bd4\u4f8b\u4e00\u6837\uff09\n\u89d2\u8272\u8d77\u59cb\u5728\u683c\u5b50\u4e2d\u5fc3\u70b9\uff0c\u884c\u8d70\u7684\u65f6\u5019\uff0c\u6309\u7167\u683c\u5b50\u7684\u5bbd\u9ad8\u6bd4\uff0c\u628a\u901f\u5ea6\u5206\u89e3\u4e3ax\u3001y\u4e24\u4e2a\u65b9\u5411\uff0c\u8fd9\u6837\u89d2\u8272\u5c31\u80fd\u6cbf\u7740\u683c\u5b50\u8d70\u4e0b\u53bb\u3002\u6bcf\u6b21\u8d70\u5230\u683c\u5b50\u4e2d\u5fc3\u65f6\u624d\u505a\u7ad9\u7acb\u3001\u7ee7\u7eed\u884c\u8d70\u7684\u5904\u7406\u3002\n\u906e\u6321\u65b9\u9762\uff0c45\u5ea6\u89d2\u4f9d\u7136\u662f\u4ece\u4e0a\u5230\u4e0b\u906e\u6321\n\n\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5efa\u7b51\u5360\u591a\u683c\uff0c\u800c\u8bbe\u7f6e\u906e\u6321\u65f6\u53ea\u80fd\u8bbe\u7f6ezorder\uff0c\u6240\u4ee5\u91c7\u7528\u7684\u662f\u4e2d\u5fc3\u4f4d\u7f6e\u65b9\u5f0f\uff0c\u628a\u5efa\u7b51\u4e2d\u5fc3\u683c\u5b50\u4f5c\u4e3azorder\u7684\u53c2\u7167\u3002\u89d2\u8272\u5728\u5730\u56fe\u4e2d\u884c\u8d70\u7684\u65f6\u5019\uff0c\u6309\u4e0a\u56fe\u7684\u89c4\u5219\u4fee\u6539\u89d2\u8272\u7684zorder\uff0c\u5efa\u7b51\u7684zorder\u4e00\u76f4\u4e0d\u53d8\u3002\n\u81ea\u7531\u88c5\u9970\u5c42\u6ca1\u6709\u6446\u653e\u9650\u5236\uff0c\u53ef\u4ee5\u653e\u7f6e\u4e91\u6735\u3001\u96fe\u7b49\u52a8\u753b\uff0c\u589e\u52a0\u5c42\u6b21\u611f\u3002\n\u74e6\u7247\u5730\u56fe\u5148\u8bf4\u5230\u8fd9\u91cc\uff0c\u4e0b\u4e00\u7bc7\u6211\u4eec\u5c06\u4ecb\u7ecdA*\u5bfb\u8def\u7b97\u6cd5\u3002","categories":"\u6559\u7a0b","tags":[""]},{"title":" A*\u5bfb\u8def","url":"https:\/\/naka1205.github.io\/cocos\/p\/D44D258BFB70E858.html","content":"A*\u5bfb\u8def\n\u8fd9\u4e00\u7bc7\u4ecb\u7ecdA\u5bfb\u8def\u7b97\u6cd5\u3002\u5728RPG\u3001SLG\u3001\u6a21\u62df\u7ecf\u8425\u7c7b\u6e38\u620f\uff0c\u6709\u9700\u8981\u7ed9\u89d2\u8272\u5bfb\u8def\u7684\u9700\u6c42\uff0c\u4e00\u822c\u5bfb\u8def\u6211\u4eec\u91c7\u7528A\u5bfb\u8def\u7b97\u6cd5\uff0cA*\u5bfb\u8def\u7b97\u6cd5\u662f\u4e00\u79cd\u5e7f\u5ea6\u4f18\u5148\u542f\u53d1\u6027\u7b97\u6cd5\u3002\n\u5148\u8bf4\u8bf4\u4ec0\u4e48\u53eb\u5e7f\u5ea6\u4f18\u5148\u3002\u641c\u7d22\u5206\u4e3a\u5e7f\u5ea6\u4f18\u5148\u548c\u6df1\u5ea6\u4f18\u5148\uff0c\u4e3b\u8981\u4f53\u73b0\u5728\u5bf9\u8282\u70b9\u7684\u5c55\u5f00\u4e0a\u3002\u6df1\u5ea6\u4f18\u5148\u4e00\u76f4\u5f80\u4e00\u4e2a\u65b9\u5411\u67e5\u627e\uff0c\u5982\u679c\u6ca1\u529e\u6cd5\u67e5\u627e\u4e0b\u53bb\uff0c\u5728\u5f53\u524d\u8282\u70b9\u6539\u53d8\u65b9\u5411\u7ee7\u7eed\u67e5\u627e\uff0c\u76f4\u5230\u627e\u5230\u7ec8\u70b9\u3002\u5982\u679c\u65e0\u6cd5\u7ee7\u7eed\u67e5\u627e\uff0c\u5c31\u56de\u9000\u4e0a\u4e00\u683c\u91cd\u590d\u64cd\u4f5c\u3002\u5e7f\u5ea6\u4f18\u5148\u628a\u5f53\u524d\u8282\u70b9\u653e\u5165\u5f85\u63a2\u7d22\u5217\u8868\uff0c\u5faa\u73af\u4ece\u5f85\u63a2\u7d22\u5217\u8868\u91cc\u53d6\u51fa\u8282\u70b9\u8fdb\u884c\u5c55\u5f00\uff0c\u76f4\u5230\u627e\u5230\u7ec8\u70b9\u3002\u5982\u679c\u5f85\u63a2\u7d22\u5217\u8868\u4e3a\u7a7a\uff0c\u8bf4\u660e\u6ca1\u6709\u8def\u53ef\u8d70\u3002\n\u542f\u53d1\u6027\u6307\u7b97\u6cd5\u5728\u5f85\u63a2\u7d22\u5217\u8868\u91cc\u53d6\u8282\u70b9\u65f6\uff0c\u5148\u9884\u6d4b\u54ea\u4e2a\u8282\u70b9\u7684\u8def\u5f84\u53ef\u80fd\u4f1a\u6700\u77ed\uff0c\u4f18\u5148\u5bf9\u8be5\u8282\u70b9\u5c55\u5f00\uff0cA*\u7b97\u6cd5\u57fa\u4e8e\u5bf9\u672a\u63a2\u7d22\u8def\u5f84\u7684\u5047\u8bbe\u548c\u9884\u6d4b\uff0c\u5047\u8bbe\u6240\u6709\u8def\u90fd\u80fd\u901a\u884c\u524d\u63d0\u4e0b\u603b\u8def\u5f84\u6700\u77ed\u503c\u3002\u5728\u56fe\u8bba\u91cc\uff0c\u4ecb\u7ecd\u8fc7\u6709\u4e00\u79cd\u5bfb\u627e\u6700\u77ed\u8def\u5f84\u7684\u7b97\u6cd5\u53ebDijkstra\u7b97\u6cd5\uff0c\u8be5\u7b97\u6cd5\u57fa\u4e8e\u8d2a\u5fc3\u7b97\u6cd5\uff0c\u5373\u5f53\u524d\u9009\u62e9\u63a2\u7d22\u7684\u8282\u70b9\uff0c\u4e3a\u5c1a\u672a\u786e\u5b9a\u6700\u77ed\u8def\u5f84\uff0c\u5f53\u524d\u6e90\u70b9\u80fd\u5230\u8fbe\u4e14\u8def\u5f84\u6700\u77ed\u7684\u8282\u70b9\u3002Dijkstra\u7b97\u6cd5\u57fa\u4e8e\u5df2\u77e5\u8ddd\u79bb\u6e90\u70b9\u6700\u77ed\u3002\u4e3a\u4e86\u4fbf\u4e8e\u7406\u89e3\u8fd9\u4e24\u79cd\u7b97\u6cd5\u7684\u533a\u522b\uff0c\u5148\u4ecb\u7ecd\u4e0bDijkstra\u7b97\u6cd5\u3002\nDijkstra\u7b97\u6cd5\u77e5\u9053\u6240\u6709\u53ef\u80fd\u7684\u8282\u70b9\uff0c\u5982\u4e0b\u56fe\uff0c\u77e5\u9053\u603b\u5171\u6709ABCDE5\u4e2a\u8282\u70b9\uff0c\u5bfb\u627e\u4eceA\u70b9\u51fa\u53d1\u5230\u5404\u70b9\u7684\u6700\u77ed\u8def\u5f84\u3002\n\n\n\n\u7b97\u6cd5\u6709\u4e24\u4e2a\u6570\u7ec4\uff0c\u4e00\u4e2a\u7ef4\u62a4\u5f53\u524d\u5df2\u77e5\u6700\u7ec8\u6700\u77ed\u8def\u5f84\u7684\u8282\u70b9\u6570\u7ec4S\uff0c\u627e\u5230\u4e3a\u8def\u5f84\u5b57\u7b26\u4e32\u548c\u957f\u5ea6\uff0c\u5426\u5219\u4e3a\u7a7a\u5b57\u7b26\u4e32\uff0c\u521d\u59cb\u53ea\u6709\u8d77\u70b9A\u70b9\u6807\u8bb0\u4e3a\u201cA\u201d\u3002\u53e6\u4e00\u4e2a\u6570\u7ec4V\uff0c\u7ef4\u62a4\u5404\u4e2a\u8282\u70b9\u201c\u76ee\u524d\u6240\u77e5\u201d\u4ece\u6e90\u70b9\u51fa\u53d1\u6700\u77ed\u7684\u8def\u5f84\u957f\u5ea6\uff08\u4e0d\u4e00\u5b9a\u662f\u6700\u7ec8\u7684\u6700\u77ed\u8def\u5f84\uff0c\u521d\u59cbB\u6807\u8bb0\u4e3a6\uff0cD\u4e3a7\uff09\uff0c\u5df2\u7ecf\u627e\u5230\u6700\u7ec8\u6700\u77ed\u8def\u5f84\u7684\u6807\u8bb0\u4e3a0\uff08\u521d\u59cb\u65f6\u8d77\u70b9A\u6807\u8bb0\u4e3a0\uff09\uff0c\u76ee\u524d\u65e0\u6cd5\u5230\u8fbe\u7684\u6807\u8bb0\u4e3a\u65e0\u7a77\u5927\u3002\n\n\n\u5faa\u73af\u4ece\u6570\u7ec4V\u4e2d\u83b7\u53d6\u6807\u8bb0\u975e0\uff0c\u975e\u65e0\u7a77\u5927\uff0c\u8def\u5f84\u6700\u77ed\u7684\u8282\u70b9\uff0c\u5728\u6570\u7ec4S\u4e2d\u6807\u8bb0\u4e3a1\uff0c\u4fee\u6b63V\u4e2d\u5176\u4ed6\u8282\u70b9\u7684\u6700\u77ed\u8def\u5f84\u3002\u76f4\u5230\u6570\u7ec4S\u4e2d\u6240\u6709\u8282\u70b9\u90fd\u6807\u8bb0\u4e3a1\n\n\n\u5982\u4e0a\u56fe\uff0c\u5bfb\u8def\u7684\u8fc7\u7a0b\u4e3a\uff1a\nV\uff1a\uff08A\uff0c0\uff09\uff0c\uff08B\uff1a6\uff09\uff0c\uff08C\uff1a\u65e0\u7a77\u5927\uff09\uff0c\uff08D\uff1a7\uff09\uff0c\uff08E\uff1a\u65e0\u7a77\u5927\uff09\uff0cS\uff1a\uff08A\uff0c\u201cA\u201d\uff09\uff0c\uff08B\uff1a\u201c\u201d\uff09\uff0c\uff08C\uff1a\u201c\u201d\uff09\uff0c\uff08D\uff1a\u201c\u201d\uff09\uff0c\uff08E\uff1a\u201c\u201d\uff09\nV\uff1a\uff08A\uff0c0\uff09\uff0c\uff08B\uff1a0\uff09\uff0c\uff08C\uff1a11\uff09\uff0c\uff08D\uff1a7\uff09\uff0c\uff08E\uff1a18\uff09\uff0cS\uff1a\uff08A\uff0c\u201cA\u201d\uff09\uff0c\uff08B\uff1a\u201cAB\u201d\uff09\uff0c\uff08C\uff1a\u201c\u201d\uff09\uff0c\uff08D\uff1a\u201c\u201d\uff09\uff0c\uff08E\uff1a\u201c\u201d\uff09\nV\uff1a\uff08A\uff0c0\uff09\uff0c\uff08B\uff1a0\uff09\uff0c\uff08C\uff1a10\uff09\uff0c\uff08D\uff1a0\uff09\uff0c\uff08E\uff1a18\uff09\uff0cS\uff1a\uff08A\uff0c\u201cA\u201d\uff09\uff0c\uff08B\uff1a\u201cAB\u201d\uff09\uff0c\uff08C\uff1a\u201c\u201d\uff09\uff0c\uff08D\uff1a\u201cAD\u201d\uff09\uff0c\uff08E\uff1a\u201c\u201d\uff09\nV\uff1a\uff08A\uff0c0\uff09\uff0c\uff08B\uff1a0\uff09\uff0c\uff08C\uff1a0\uff09\uff0c\uff08D\uff1a0\uff09\uff0c\uff08E\uff1a18\uff09\uff0cS\uff1a\uff08A\uff0c\u201cA\u201d\uff09\uff0c\uff08B\uff1a\u201cAB\u201d\uff09\uff0c\uff08C\uff1a\u201cADC\u201d\uff09\uff0c\uff08D\uff1a\u201cAD\u201d\uff09\uff0c\uff08E\uff1a\u201c\u201d\uff09\nV\uff1a\uff08A\uff0c0\uff09\uff0c\uff08B\uff1a0\uff09\uff0c\uff08C\uff1a0\uff09\uff0c\uff08D\uff1a0\uff09\uff0c\uff08E\uff1a0\uff09\uff0cS\uff1a\uff08A\uff0c\u201cA\u201d\uff09\uff0c\uff08B\uff1a\u201cAB\u201d\uff09\uff0c\uff08C\uff1a\u201cADC\u201d\uff09\uff0c\uff08D\uff1a\u201cAD\u201d\uff09\uff0c\uff08E\uff1a\u201cABE\u201d\uff09\n\u8fd9\u91cc\uff0cDijkstra\u7b97\u6cd5\u57fa\u4e8e\u77e5\u9053\u6240\u6709\u53ef\u80fd\u7684\u8282\u70b9\uff0c\u76ee\u6807\u8282\u70b9\u4e5f\u6709\u591a\u4e2a\uff0c\u6bcf\u4e2a\u8282\u70b9\u53ef\u4ee5\u76f4\u63a5\u5230\u8fbe\u7684\u8282\u70b9\u6570\u6ca1\u6709\u9650\u5236\u3002\n\u6e38\u620f\u91cc\u7684\u5bfb\u8def\u662f\u76ee\u6807\u8282\u70b9\u53ea\u6709\u4e00\u4e2a\uff0c\u4e2d\u95f4\u8282\u70b9\u53ef\u80fd\u6709\u591a\u4e2a\uff0c\u6bcf\u4e2a\u8282\u70b9\u53ef\u4ee5\u76f4\u63a5\u5230\u8fbe\u7684\u8282\u70b9\u6570\u6700\u591a4\u4e2a\uff08\u5982\u679c\u662f8\u4e2a\u65b9\u5411\u662f8\uff09\n\n\u5c06\u6570\u7ec4\u6539\u6210\u5217\u8868\u4f1a\u66f4\u7075\u6d3b\uff0c\u73b0\u5728\u5c06\u6570\u7ec4V\u6539\u6210open\u961f\u5217\uff0c\u5c06\u6570\u7ec4S\u6539\u6210close\u961f\u5217\u3002\u5982\u4e0a\u56fe\uff0c\u8981\u627e\u5230A\u5230E\u7684\u8def\u5f84\uff0c\u4ecd\u7136\u6309\u7167Dijkstra\u7b97\u6cd5\u601d\u8def\uff0c\n\n\n\u5148\u5c06A\u653e\u5165open\u961f\u5217\uff0c\u8def\u5f84\u957f\u5ea6\u4e3a0\n\n\n\u5faa\u73af\u4eceopen\u5217\u8868\u91cc\u62ff\u51fa\u8def\u5f84\u957f\u5ea6\u6700\u77ed\u7684\u8282\u70b9\uff0c\u5c06\u5176\u653e\u5165close\u961f\u5217\u5e76\u8bb0\u5f55\u4e0a\u4e00\u8282\u70b9\uff0c\u5bf9\u51764\u4e2a\u65b9\u5411\u8fdb\u884c\u5c55\u5f00\uff0c\u5982\u679c\u5df2\u7ecf\u5728open\u3001close\u961f\u5217\uff0c\u4fee\u6b63\u5176\u6700\u77ed\u8def\u5f84\u957f\u5ea6\uff1b\u5982\u679c\u4e0d\u53ef\u8d70\uff0c\u5ffd\u7565\uff1b\u5426\u5219\u653e\u5165open\u961f\u5217\u5e76\u8ba1\u7b97\u5176\u8def\u5f84\u957f\u5ea6\u3002\n\n\n\u5982\u679c\u627e\u5230E\u70b9\uff0c\u901a\u8fc7E\u70b9\u7684\u4e0a\u4e00\u8282\u70b9\uff0c\u4e0a\u4e00\u8282\u70b9\u7684\u4e0a\u4e00\u8282\u70b9...\u4e00\u76f4\u53cd\u63a8\u5230A\u70b9\uff0c\u5f62\u6210\u53cd\u63a8\u8def\u5f84\uff0c\u4ece\u800c\u627e\u5230A\u5230E\u7684\u6700\u77ed\u8def\u5f84\u3002\n\n\n\u5982\u679c\u8fd8\u6ca1\u627e\u5230E\u70b9\uff0copen \u961f\u5217\u4e3a\u7a7a\uff0cA\u5230E\u8def\u4e0d\u901a\u3002\n\n\n\u5982\u4e0a\u56fe\uff0c\u4eceDijkstra\u7b97\u6cd5\u4fee\u6539\u8fc7\u6765\u7684\u5bfb\u8def\u7b97\u6cd5\uff0c\u6309\u7167\u7ea2\u8272\u3001\u7eff\u8272\u3001\u84dd\u8272\u3001\u9ec4\u8272\u8282\u70b9\uff0c\u9010\u6b65\u5c55\u5f00\u5bfb\u627e\u624d\u627e\u5230A\u5230E\u7684\u6700\u77ed\u8def\u5f84\uff0c\u5f88\u591a\u6ca1\u7528\u7684\u5206\u652f\uff0c\u6548\u7387\u4f4e\u3002\nA\u7684\u4f18\u5316\u601d\u8def\u4e3b\u8981\u5728\u6311\u9009\u8282\u70b9\u5c55\u5f00\u65f6\uff0c\u5047\u8bbe\u627e\u5230\u4e00\u4e2a\u4e2d\u95f4\u8282\u70b9B\u540e\uff0c\u4e2d\u95f4\u8282\u70b9B\u5230E\u7684\u8def\u90fd\u662f\u53ef\u8d70\u7684\u3002\u8fd9\u65f6\u5019\u6700\u77ed\u8def\u5f84\u957f\u5ea6\u662f\u8ba1\u7b97\u7ecf\u8fc7B\u70b9A\u5230E\u7684\u6700\u77ed\u8def\u5f84\uff08AB\uff09+\uff08BE\uff09\u3002\u5728RPG\u6e38\u620f\u4e2d\uff0c\u6700\u7b80\u5355\u7684\u60c5\u51b5\u662f\uff0cA\u5230B\u7684\u8def\u5f84\u957f\u5ea6\u7b49\u4e8e\u4eceA\u8d70\u5230B\u7ecf\u8fc7\u7684\u683c\u5b50\u6570\uff0cB\u5230E\u7684\u8def\u5f84\u957f\u5ea6\u7b49\u4e8e\u5047\u8bbeB\u5230E\u7684\u8def\u90fd\u76f8\u901a\u60c5\u51b5\u4e0bB\u8d70\u5230E\u7ecf\u8fc7\u7684\u683c\u5b50\u6570\u3002A\u7b97\u6cd5\u6bcf\u6b21\u5c55\u5f00\u8282\u70b9\u65f6\u90fd\u5c3d\u53ef\u80fd\u7684\u5f80\u53ef\u80fd\u6700\u77ed\u7684\u8def\u5f84\u53bb\u5c55\u5f00\u5bfb\u627e\uff0c\u51cf\u5c11\u6ca1\u5fc5\u8981\u7684\u5206\u652f\uff0c\u63d0\u9ad8\u5bfb\u8def\u6548\u7387\u3002\n\u4e0b\u9762\u662fA*\u5bfb\u8def\u7b97\u6cd5\u8fc7\u7a0b\n\n\n\u5148\u5c06A\u653e\u5165open\u961f\u5217\uff0c\u8bb0\u5f55\u5176\u4e0a\u4e00\u8282\u70b9\u4e3a\u7a7a\n\n\n\u5faa\u73af\u4eceopen\u5217\u8868\u91cc\u62ff\u51fa\u8282\u70b9N\uff0cN\u4e3a\u7ecf\u8fc7\u8be5\u70b9N\uff0cA\u5230E\u8def\u5f84\u9884\u6d4b\u957f\u5ea6\u6700\u77ed\u7684\u8282\u70b9\uff0c\u5c06\u5176\u653e\u5165close\u961f\u5217\uff1b\u5bf9\u51764\u4e2a\u65b9\u5411\u8fdb\u884c\u5c55\u5f00\uff0c\u5982\u679c\u5df2\u7ecf\u5728open\u3001close\u961f\u5217\uff0c\u4fee\u6b63\u5176\u4e0a\u4e00\u8282\u70b9\uff1b\u5982\u679c\u4e0d\u53ef\u8d70\uff0c\u5ffd\u7565\uff1b\u5426\u5219\u653e\u5165open\u961f\u5217\u5e76\u8bb0\u5f55\u5176\u4e0a\u4e00\u8282\u70b9\u4e3aN\u3002\n\n\n\u5982\u679c\u627e\u5230E\u70b9\uff0c\u901a\u8fc7E\u70b9\u7684\u4e0a\u4e00\u8282\u70b9\uff0c\u4e0a\u4e00\u8282\u70b9\u7684\u4e0a\u4e00\u8282\u70b9...\u4e00\u76f4\u53cd\u63a8\u5230A\u70b9\uff0c\u5f62\u6210\u53cd\u63a8\u8def\u5f84\uff0c\u4ece\u800c\u627e\u5230A\u5230E\u7684\u6700\u77ed\u8def\u5f84\u3002\n\n\n\u5982\u679c\u8fd8\u6ca1\u627e\u5230E\u70b9\uff0copen \u961f\u5217\u4e3a\u7a7a\uff0cA\u5230E\u8def\u4e0d\u901a\u3002\n\n\nA*\u5bfb\u8def\u7b97\u6cd5\u5148\u8bf4\u5230\u8fd9\u91cc\uff0c\u4e0b\u4e00\u7bc7\u6211\u4eec\u5c06\u4ecb\u7ecd\u6709\u9650\u72b6\u6001\u673a\u548c\u884c\u4e3a\u6811\u3002","categories":"\u6559\u7a0b","tags":[""]},{"title":"\u6709\u9650\u72b6\u6001\u673a\u548c\u884c\u4e3a\u6811","url":"https:\/\/naka1205.github.io\/cocos\/p\/FB97038B212BD9C7.html","content":"\u6709\u9650\u72b6\u6001\u673a\u548c\u884c\u4e3a\u6811\n\u672c\u7bc7\u4ecb\u7ecd\u6709\u9650\u72b6\u6001\u673a\u548c\u884c\u4e3a\u6811\u3002\u6709\u9650\u72b6\u6001\u673a\u7528\u4e8e\u6709\u9650\u7684\u72b6\u6001\u4e0b\u7684AI\uff0c\u7531\u4e8e\u540c\u65f6\u53ea\u80fd\u5904\u4e8e\u4e00\u4e2a\u72b6\u6001\uff0c\u591a\u4e2a\u72b6\u6001\u9700\u8981\u591a\u4e2a\u6709\u9650\u72b6\u6001\u673a\uff0c\u4e00\u822c\u7528\u4e8e\u7b80\u5355\u7684AI\u884c\u4e3a\u3002\u884c\u4e3a\u6811\u662f\u57fa\u4e8e\u56fa\u5b9a\u884c\u4e3a\uff0c\u901a\u8fc7\u904d\u5386\u6811\u6765\u51b3\u5b9a\u91c7\u7528\u54ea\u79cd\u884c\u4e3a\u3002\u884c\u4e3a\u7684\u8bbe\u8ba1\u548c\u6267\u884c\u91c7\u7528\u89e3\u91ca\u5668\u6a21\u5f0f\uff0c\u7531\u7b56\u5212\u8bbe\u8ba1\u6570\u636e\uff0c\u7a0b\u5e8f\u89e3\u6790\u6267\u884c\uff0c\u884c\u4e3a\u7ec4\u5408\u7684\u7075\u6d3b\u6027\u9ad8\uff0c\u6bd4\u8f83\u9002\u5408\u5267\u60c5NPC\u3002\u4f46\u5f53\u6811\u6bd4\u8f83\u6df1\u3001\u5206\u652f\u6bd4\u8f83\u591a\u65f6\uff0c\u904d\u5386\u7684\u6548\u7387\u5c31\u9700\u8981\u8003\u8651\u4f18\u5316\u3002\u4e00\u822c\u6211\u4eec\u8ba4\u4e3a\u6709\u9650\u72b6\u6001\u673a\u6267\u884c\u7684\u6027\u80fd\u4f18\u4e8e\u884c\u4e3a\u6811\uff0c\u4f46\u4e0d\u80fd\u80dc\u4efb\u590d\u6742\u3001\u7075\u6d3b\u7684AI\u8bbe\u8ba1\u3002\u800c\u884c\u4e3a\u6811\u5219\u6bd4\u8f83\u9002\u5408\u590d\u6742\u3001\u7075\u6d3b\u7684AI\u8bbe\u8ba1\u3002\n\u5148\u4ecb\u7ecd\u4e0b\u6709\u9650\u72b6\u6001\u673a\u3002\u8003\u8651\u5728\u4e00\u4e2a\u7c7b\u4f3c\u300a\u5200\u5854\u4f20\u5947\u300b\u7684\u6a2a\u7248\u52a8\u4f5c\u5361\u724c\u6e38\u620f\u7684\u6218\u6597\u91cc\uff0c\u6bcf\u4e2a\u82f1\u96c4\u6709\u51fa\u573a\u3001\u7ad9\u7acb\u3001\u8d70\u4f4d\u3001\u53d7\u51fb\u3001\u541f\u5531\u3001\u65bd\u6cd5\u7b49\u72b6\u6001\u3002\u82f1\u96c4\u6bcf\u65f6\u6bcf\u523b\u53ea\u80fd\u5904\u5728\u8fd9\u4e9b\u72b6\u6001\u4e2d\u5176\u4e2d\u4e00\u4e2a\u72b6\u6001\uff0c\u6bcf\u4e2a\u72b6\u6001\u90fd\u6709\u81ea\u5df1\u7684\u903b\u8f91\uff0c\u72b6\u6001\u7684\u6539\u53d8\u90fd\u7531\u4e8b\u4ef6\u9a71\u52a8\u3002\u50cf\u8fd9\u6837\u7b80\u5355\u7684AI\uff0c\u53ef\u4ee5\u4f7f\u7528\u6709\u9650\u72b6\u6001\u673a\u6765\u5b9e\u73b0\u3002\n\u6709\u9650\u72b6\u6001\u673a\u5305\u62ec\u51e0\u4e2a\u8981\u7d20\uff1a\n\n\n\u72b6\u6001\uff0c\u72b6\u6001\u673a\u540c\u65f6\u53ea\u80fd\u5904\u4e8e\u4e00\u4e2a\u72b6\u6001\uff0c\u5728\u6307\u5b9a\u72b6\u6001\u4e0b\u6709\u76f8\u5e94\u7684\u903b\u8f91\uff0c\u4f8b\u5982\u884c\u8d70\u72b6\u6001\uff0c\u64ad\u653e\u884c\u8d70\u52a8\u753b\uff0c\u6bcf\u5e27\u4fee\u6539\u82f1\u96c4\u7684x\u3001y\u503c\n\n\n\u4e8b\u4ef6\uff0c\u4e8b\u4ef6\u662f\u72b6\u6001\u8f6c\u53d8\u7684\u89e6\u53d1\u5668\uff0c\u5305\u62ec\u5185\u90e8\u4e8b\u4ef6\u548c\u5916\u90e8\u4e8b\u4ef6\u3002\u4f8b\u5982\u6700\u8fd1\u7684\u654c\u4eba\u8fbe\u5230\u653b\u51fb\u8ddd\u79bb\uff0c\u89e6\u53d1\u4ece\u884c\u8d70\u72b6\u6001\u8f6c\u53d8\u4e3a\u7ad9\u7acb\u72b6\u6001\u3002CD\u65f6\u95f4\u5230\u8fbe\uff0c\u89e6\u53d1\u4ece\u7ad9\u7acb\u72b6\u6001\u8f6c\u53d8\u4e3a\u65bd\u6cd5\u72b6\u6001\n\n\n\u72b6\u6001\u8f6c\u53d8\uff0c\u72b6\u6001\u95f4\u53ef\u4ee5\u76f8\u4e92\u8f6c\u53d8\uff0c\u8f6c\u53d8\u8fc7\u7a0b\u6709\u5bf9\u5e94\u7684\u903b\u8f91\u3002\u4f8b\u5982\u4ece\u884c\u8d70\u72b6\u6001\u8f6c\u53d8\u4e3a\u7ad9\u7acb\u72b6\u6001\uff0c\u64ad\u653e\u7ad9\u7acb\u52a8\u4f5c\u3002\n\n\n\u73b0\u5728\u6765\u4ecb\u7ecd\u4e0b\u884c\u4e3a\u6811\u3002\u5728RPG\u6e38\u620f\u4e2d\uff0c\u5730\u56fe\u4e0a\u5b58\u5728\u4e00\u4e9b\u5267\u60c5NPC\uff0c\u4e0d\u540c\u7684\u5267\u60c5\u4e0b\uff0cNPC\u7684\u884c\u4e3a\u4f1a\u4e0d\u4e00\u6837\u3002\u8fd9\u4e9bNPC\u7684\u884c\u4e3a\u53ef\u4ee5\u901a\u8fc7\u884c\u4e3a\u6811\u8fdb\u884c\u7ba1\u7406\u3002\u884c\u4e3a\u6811\u662f\u5728\u56fa\u6709\u884c\u4e3a\u96c6\u4e0b\uff0c\u8fdb\u884c\u884c\u4e3a\u6289\u62e9\u7684AI\u7b97\u6cd5\u3002\u884c\u4e3a\u6811\u5305\u62ec\u6570\u636e\u89e3\u6790\u3001\u903b\u8f91\u63a7\u5236\u3001\u884c\u4e3a\u6267\u884c\u4e09\u90e8\u5206\u3002\n\u884c\u4e3a\u6811\u6570\u636e\u7531\u8282\u70b9\u7ec4\u6210\uff0c\u6bcf\u4e2a\u8282\u70b9\u6709\u5bf9\u5e94\u7684\u884c\u4e3a\u7c7b\u578b\u3001\u53c2\u6570\u3001\u8fd4\u56de\u503c\u3002\u8282\u70b9\u6709\u4e00\u4e2a\u5b50\u8282\u70b9\u6570\u7ec4\uff0c\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u5c06\u8282\u70b9\u7ec4\u7ec7\u6210\u6811\u72b6\u3002\nexport class BehaviorNode {\n    private type: number = 0;\n    private params: any = null;\n    private retVal: any = null;\n    private subBehaviors: Array&lt;BehaviorNode&gt; = [];\n}\n\u903b\u8f91\u63a7\u5236\u8282\u70b9\u90fd\u6709\u5b50\u8282\u70b9\uff0c\u903b\u8f91\u63a7\u5236\u6307\u7684\u662f\u8ddf\u7f16\u7a0b\u7c7b\u4f3c\u7684if\u6761\u4ef6\u5224\u65ad\u3001while\u5faa\u73af\u3001\u4e32\u884c\u6267\u884c\u3001\u5e76\u884c\u6267\u884c\u7b49\u3002if\u884c\u4e3a\u5982\u679c\u8fd4\u56detrue\uff0c\u6267\u884c\u5b50\u8282\u70b9\u884c\u4e3a\uff0c\u5b50\u884c\u4e3a\u7ed3\u675f\u5219\u6574\u4f53\u884c\u4e3a\u7ed3\u675f\u3002while\u884c\u4e3a\u5982\u679c\u8fd4\u56detrue\uff0c\u6267\u884c\u5b50\u8282\u70b9\u884c\u4e3a\uff0c\u5982\u679c\u5b50\u8282\u70b9\u7ed3\u675f\uff0c\u91cd\u7f6e\u5b50\u8282\u70b9\u91cd\u65b0\u6267\u884c\u3002\u4e32\u884c\u884c\u4e3a\uff0c\u5b50\u8282\u70b9\u4e00\u6761\u4e00\u6761\u7684\u4f9d\u6b21\u6267\u884c\uff0c\u5b50\u8282\u70b9\u7ed3\u675f\u5219\u6574\u4f53\u7ed3\u675f\u3002\u5e76\u884c\u884c\u4e3a\uff0c\u5b50\u8282\u70b9\u540c\u65f6\u6267\u884c\uff0c\u5b50\u8282\u70b9\u7ed3\u675f\u5219\u6574\u4f53\u7ed3\u675f\u3002\n\n\u884c\u4e3a\u6811\u7684\u53f6\u8282\u70b9\u662f\u5b9e\u9645\u884c\u4e3a\u6267\u884c\u7684\u8282\u70b9\uff0c\u5728\u5f00\u53d1\u4e00\u6b3eRPG\u6e38\u620f\u65f6\uff0c\u9700\u8981\u6839\u636e\u5267\u60c5\u9700\u8981\uff0c\u63d0\u70bc\u51fa\u89d2\u8272\u7684\u7ec6\u7c92\u884c\u4e3a\uff0c\u4f8b\u5982\u884c\u8d70\u3001\u5bf9\u8bdd\u3001\u64ad\u653e\u8868\u60c5\u3001\u5207\u6362\u52a8\u753b\u3001\u89e6\u53d1\u6218\u6597\u7b49\u3002\u4e00\u822c\u5730\uff0cRPG\u90fd\u4f1a\u5f00\u53d1\u4e00\u4e2a\u5bf9\u5e94\u7684\u5267\u60c5\u7f16\u8f91\u5668\uff0c\u5bf9\u5730\u56fe\u4e0a\u7684NPC\u8fdb\u884c\u884c\u4e3a\u8bbe\u5b9a\uff0c\u5bfc\u51fa\u5bf9\u5e94\u884c\u4e3a\u7684\u53c2\u6570\u3002\u6e38\u620f\u52a0\u8f7d\u8fd9\u4e9b\u6570\u636e\uff0c\u89e3\u6790\u751f\u6210\u884c\u4e3a\u6811\uff0cNPC\u6bcf\u5e27\u6267\u884c\u884c\u4e3a\u6811\uff0c\u53f6\u8282\u70b9\u884c\u4e3a\u6709\u5bf9\u5e94\u7684\u6267\u884c\u65b9\u6cd5\uff0c\u65b9\u6cd5\u7684\u53c2\u6570\u4e3a\u884c\u4e3a\u8282\u70b9\u7684\u53c2\u6570\u3002\nprivate _parseWalkData(): BehaviorNode {\n    \/\/ TODO \u4e8c\u8fdb\u5236\u6570\u636e\u89e3\u6790\u4e3ajson\n}\npublic execBehavior(b: BehaviorNode): void {\n    if (!b) {\n        return;\n    }\n    switch(b.type) {\n        case BehaviorType.WALK:\n            this.execWalk(b);\n            break;\n    }\n}\nprivate _execWalk(b: BehaviorNode): void {\n    let actorId = b.params.id;\n    let destGridX = b.params.destGridX;\n    let destGridY = b.params.destGridY;\n    let actor = map.getActor(actorId);\n    let curGridX = actor.gridX;\n    let curGridY = actor.gridY;\n    let loadGrids = AStar.findLoad(curGridX, curGridY, destGridX, destGridY);\n    actor.setLoad(loadGrids);\n}\n\u4e00\u822c\u5730\uff0c\u6e38\u620f\u5730\u56fe\u4e2d\u7684\u7269\u4ef6\u90fd\u53ef\u4ee5\u6302\u8f7d\u884c\u4e3a\u6811\uff0c\u5730\u56fe\u672c\u8eab\u3001\u89d2\u8272\u3001\u5730\u56fe\u7269\u54c1\u7b49\uff0c\u5c06\u4e00\u4e2a\u5267\u60c5\u7684\u590d\u6742\u884c\u4e3a\uff0c\u5206\u62c6\u5230\u6bcf\u4e00\u4e2a\u5730\u56fe\u7269\u4ef6\u4e0a\uff0c\u901a\u8fc7\u5267\u60c5\u4efb\u52a1\u4f5c\u4e3a\u6761\u4ef6\u533a\u5206\u89e6\u53d1\uff0c\u7b80\u5316\u884c\u4e3a\u7684\u7ec4\u7ec7\u3002\u7a0b\u5e8f\u5458\u53ea\u8d1f\u8d23\u5c06\u7b56\u5212\u7684\u8bbe\u5b9a\u63d0\u53d6\u51fa\u7ec6\u7c92\u884c\u4e3a\uff0c\u7f16\u5199\u5bf9\u5e94\u7684\u6570\u636e\u89e3\u6790\u548c\u6267\u884c\u65b9\u6cd5\uff0c\u7531\u7b56\u5212\u4f7f\u7528\u7f16\u8f91\u5668\u7f16\u8f91\u6570\u636e\uff0c\u7531\u6570\u636e\u9a71\u52a8\u5267\u60c5\u7684\u63a8\u8fdb\u3002\n\u6709\u9650\u72b6\u6001\u673a\u548c\u884c\u4e3a\u6811\u5148\u8bf4\u5230\u8fd9\u91cc\uff0c\u4e0b\u4e00\u7bc7\u6211\u4eec\u5c06\u4ecb\u7ecd\u72b6\u6001\u540c\u6b65\u3002","categories":"\u6559\u7a0b","tags":[""]}]